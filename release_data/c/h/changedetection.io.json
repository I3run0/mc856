{"0.38.2":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":"","project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.38.2/","requires_dist":["apprise (~=0.9)","bs4","chardet (==2.3.0)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask (~=1.0)","inscriptis (~=1.2)","jsonpath-ng (~=1.5.3)","pytz","requests[socks] (~=2.15)","selenium (~=3.141)","timeago (~=1.0)","urllib3","validators","wtforms (~=2.3.3)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.38.2","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"d96e2baac7201b615a8d000f9a510ade6cc010617c9b6e3b6a498d53fb929aee","md5":"e1a9c34b65ab6e7be91ab34f7f5f387a","sha256":"1a1490ecbb4829f3300b2e7cf2e2c800e700d87a93ad380c500bc12d57a86839"},"downloads":-1,"filename":"changedetection.io-0.38.2-py3-none-any.whl","has_sig":false,"md5_digest":"e1a9c34b65ab6e7be91ab34f7f5f387a","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":353104,"upload_time":"2021-08-16T12:27:40","upload_time_iso_8601":"2021-08-16T12:27:40.354924Z","url":"https://files.pythonhosted.org/packages/d9/6e/2baac7201b615a8d000f9a510ade6cc010617c9b6e3b6a498d53fb929aee/changedetection.io-0.38.2-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":"","project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39/","requires_dist":["apprise (~=0.9)","bs4","chardet (==2.3.0)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask (~=1.0)","inscriptis (~=1.2)","jsonpath-ng (~=1.5.3)","pytz","requests[socks] (~=2.15)","selenium (~=3.141)","timeago (~=1.0)","urllib3","validators","wtforms (~=2.3.3)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"e8d8f08fe7f0287ec32844538188f7b646d98cbfee3e660cee3cbc4ad50de2a3","md5":"2863b4e0336899ac6f2835ba42def2dd","sha256":"bf6d41474e18435860c716ae5155a5242e0d04f8460e568c3ca483b52489ac41"},"downloads":-1,"filename":"changedetection.io-0.39-py3-none-any.whl","has_sig":false,"md5_digest":"2863b4e0336899ac6f2835ba42def2dd","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":351522,"upload_time":"2021-08-16T13:31:15","upload_time_iso_8601":"2021-08-16T13:31:15.502949Z","url":"https://files.pythonhosted.org/packages/e8/d8/f08fe7f0287ec32844538188f7b646d98cbfee3e660cee3cbc4ad50de2a3/changedetection.io-0.39-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.1":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":"","project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.1/","requires_dist":["apprise (~=0.9)","bs4","chardet (==2.3.0)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask (~=1.0)","inscriptis (~=1.2)","jsonpath-ng (~=1.5.3)","pytz","requests[socks] (~=2.15)","selenium (~=3.141)","timeago (~=1.0)","urllib3","validators","wtforms (~=2.3.3)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.1","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"856de37429aa489fd7e88464289995c29f7e0ae30c95f917cdec9345b9dbbcf0","md5":"553f6735a48453edf70c6155cf2c1c65","sha256":"0d34a2e070a2aff3589d6b3ebfb244fdfe33eb6f56200e2f4b91a52bbb9b4613"},"downloads":-1,"filename":"changedetection.io-0.39.1-py3-none-any.whl","has_sig":false,"md5_digest":"553f6735a48453edf70c6155cf2c1c65","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":169717,"upload_time":"2021-09-18T09:07:25","upload_time_iso_8601":"2021-09-18T09:07:25.118337Z","url":"https://files.pythonhosted.org/packages/85/6d/e37429aa489fd7e88464289995c29f7e0ae30c95f917cdec9345b9dbbcf0/changedetection.io-0.39.1-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.10":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.10/","requires_dist":["apprise (~=0.9.7)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask (~=2.0)","inscriptis (~=2.2)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytz","requests[socks] (~=2.26)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","wtforms (~=2.3.3)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.10","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"f3f519311952717b59e98780c30bc87a9c26a8be24bebc8ba8fe824811eb3abd","md5":"708b66ed8327e1122e95cf41994c99f7","sha256":"f4cc6a3fceb2ef25e2e55ed0533169cc245e99bfebc38dae8466118f9b8a6853"},"downloads":-1,"filename":"changedetection.io-0.39.10-py3-none-any.whl","has_sig":false,"md5_digest":"708b66ed8327e1122e95cf41994c99f7","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":184847,"upload_time":"2022-03-12T16:51:55","upload_time_iso_8601":"2022-03-12T16:51:55.730199Z","url":"https://files.pythonhosted.org/packages/f3/f5/19311952717b59e98780c30bc87a9c26a8be24bebc8ba8fe824811eb3abd/changedetection.io-0.39.10-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.10.post1":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.10.post1/","requires_dist":["apprise (~=0.9.7)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask (~=2.0)","inscriptis (~=2.2)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytz","requests[socks] (~=2.26)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","wtforms (~=2.3.3)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.10.post1","yanked":true,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"026a9ebe779ff9c2a8dcd4225c1e687aff7df91984af5853550dd0b20077e095","md5":"5d15a60af7aa0ff2f82e5e8191f51689","sha256":"900af2ba8aed784c98867ee4bbc21368c3df72742ed1caef5bf73e234f2ff805"},"downloads":-1,"filename":"changedetection.io-0.39.10.post1-py3-none-any.whl","has_sig":false,"md5_digest":"5d15a60af7aa0ff2f82e5e8191f51689","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":186565,"upload_time":"2022-03-12T22:02:43","upload_time_iso_8601":"2022-03-12T22:02:43.954419Z","url":"https://files.pythonhosted.org/packages/02/6a/9ebe779ff9c2a8dcd4225c1e687aff7df91984af5853550dd0b20077e095/changedetection.io-0.39.10.post1-py3-none-any.whl","yanked":true,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.10.post2":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.10.post2/","requires_dist":["apprise (~=0.9.7)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask (~=2.0)","inscriptis (~=2.2)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytz","requests[socks] (~=2.26)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","wtforms (~=2.3.3)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.10.post2","yanked":true,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"3bfe44fc17ae0ac00850fc443635bf319d831de97005f006b48909d1dd08f824","md5":"a93285405b21ee904168db27ffb9d655","sha256":"68033a7f5cadc85c7948b6250cf17160f47f113f01737b8c2a2d784212ff0e5d"},"downloads":-1,"filename":"changedetection.io-0.39.10.post2-py3-none-any.whl","has_sig":false,"md5_digest":"a93285405b21ee904168db27ffb9d655","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":198019,"upload_time":"2022-03-12T22:18:59","upload_time_iso_8601":"2022-03-12T22:18:59.662242Z","url":"https://files.pythonhosted.org/packages/3b/fe/44fc17ae0ac00850fc443635bf319d831de97005f006b48909d1dd08f824/changedetection.io-0.39.10.post2-py3-none-any.whl","yanked":true,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.11":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.11/","requires_dist":["apprise (~=0.9.7)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytz","requests[socks] (~=2.26)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","wtforms (~=2.3.3)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.11","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"9db2fa932a006dc090141984a5ac9f60857e054c3b3fc2c783d62d7da775841a","md5":"efecba4a0f47b3b97ce543b760ce2fcf","sha256":"d4395f7a609d6fc22c302b9972a39d2e26b9fd648b5daf92a34ebfb7bd38b35c"},"downloads":-1,"filename":"changedetection.io-0.39.11-py3-none-any.whl","has_sig":false,"md5_digest":"efecba4a0f47b3b97ce543b760ce2fcf","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":186237,"upload_time":"2022-03-23T08:45:27","upload_time_iso_8601":"2022-03-23T08:45:27.774424Z","url":"https://files.pythonhosted.org/packages/9d/b2/fa932a006dc090141984a5ac9f60857e054c3b3fc2c783d62d7da775841a/changedetection.io-0.39.11-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.12":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.12/","requires_dist":["apprise (~=0.9.7)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytz","requests[socks] (~=2.26)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.12","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"34889bc42fe73868e9f0888ebf981f5805fe2554e9da71beb8f0217da5c03315","md5":"13687e6038adc6f65db29ae19e949873","sha256":"5a9cdb9d3fc03015ba5e3c0348fc3ea006eb2d4c0a27bef589e5971286969c78"},"downloads":-1,"filename":"changedetection.io-0.39.12-py3-none-any.whl","has_sig":false,"md5_digest":"13687e6038adc6f65db29ae19e949873","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":260732,"upload_time":"2022-04-11T18:42:21","upload_time_iso_8601":"2022-04-11T18:42:21.796684Z","url":"https://files.pythonhosted.org/packages/34/88/9bc42fe73868e9f0888ebf981f5805fe2554e9da71beb8f0217da5c03315/changedetection.io-0.39.12-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.13":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.13/","requires_dist":["apprise (~=0.9.8.3)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytz","requests[socks] (~=2.26)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.13","yanked":true,"yanked_reason":"Broken package, please use 0.39.13.1"},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"44197842948a8c92636a3495f62a407b5e5e9ab8318a76a22b471ef506eb8b82","md5":"05781d0880fed75bd7bf2ccb36be891c","sha256":"00e798823f43f66f9aa3748c9d90e1876da032ca7b1d8b6410e032f9e95e63b6"},"downloads":-1,"filename":"changedetection.io-0.39.13-py3-none-any.whl","has_sig":false,"md5_digest":"05781d0880fed75bd7bf2ccb36be891c","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":269251,"upload_time":"2022-05-10T15:27:36","upload_time_iso_8601":"2022-05-10T15:27:36.364032Z","url":"https://files.pythonhosted.org/packages/44/19/7842948a8c92636a3495f62a407b5e5e9ab8318a76a22b471ef506eb8b82/changedetection.io-0.39.13-py3-none-any.whl","yanked":true,"yanked_reason":"Broken package, please use 0.39.13.1"}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.13.1":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.13.1/","requires_dist":["apprise (~=0.9.8.3)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytz","requests[socks] (~=2.26)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.13.1","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"08a1714d82d66ebda20756c723afc50174a9e07a4d85a4ce9b022a97ff235940","md5":"8b0962debacb5384ec1f0a51c5dd5097","sha256":"f0b66713968a74116d9865ec5d556cd5935d819182a3336283ab4f21eab49c36"},"downloads":-1,"filename":"changedetection.io-0.39.13.1-py3-none-any.whl","has_sig":false,"md5_digest":"8b0962debacb5384ec1f0a51c5dd5097","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":272006,"upload_time":"2022-05-10T20:32:55","upload_time_iso_8601":"2022-05-10T20:32:55.502887Z","url":"https://files.pythonhosted.org/packages/08/a1/714d82d66ebda20756c723afc50174a9e07a4d85a4ce9b022a97ff235940/changedetection.io-0.39.13.1-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.14":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.14/","requires_dist":["apprise (~=0.9.8.3)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytz","requests[socks] (~=2.26)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.14","yanked":true,"yanked_reason":"did not include API/"},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"41de66fea239ab96827f14a27d00b2e5feb0b4781f0d6f4a14cb7dcbdd1e2f44","md5":"d97d8f6fde0f7d799cacd8dd0cbb6297","sha256":"5ed3e8582eb2389711ebf0ee66548b356edfe0c2dd3fb6251d6249c9f9caf563"},"downloads":-1,"filename":"changedetection.io-0.39.14-py3-none-any.whl","has_sig":false,"md5_digest":"d97d8f6fde0f7d799cacd8dd0cbb6297","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":274151,"upload_time":"2022-05-23T12:43:19","upload_time_iso_8601":"2022-05-23T12:43:19.748619Z","url":"https://files.pythonhosted.org/packages/41/de/66fea239ab96827f14a27d00b2e5feb0b4781f0d6f4a14cb7dcbdd1e2f44/changedetection.io-0.39.14-py3-none-any.whl","yanked":true,"yanked_reason":"did not include API/"}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.14.1":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.14.1/","requires_dist":["apprise (~=0.9.8.3)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytz","requests[socks] (~=2.26)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.14.1","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"f31f0e4329ba85a9899dab5404cd07c0736d471ab4daaabf833bc4435cd9d52b","md5":"95d12c70ed5aefe076bffc24cc20aeba","sha256":"669e88a12d2e9c69b2d1025a15562998dfb08dd11d8a72659ddfaf99b839c140"},"downloads":-1,"filename":"changedetection.io-0.39.14.1-py3-none-any.whl","has_sig":false,"md5_digest":"95d12c70ed5aefe076bffc24cc20aeba","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":301604,"upload_time":"2022-05-23T22:18:34","upload_time_iso_8601":"2022-05-23T22:18:34.461012Z","url":"https://files.pythonhosted.org/packages/f3/1f/0e4329ba85a9899dab5404cd07c0736d471ab4daaabf833bc4435cd9d52b/changedetection.io-0.39.14.1-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.15":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.15/","requires_dist":["apprise (~=0.9.9)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytz","requests[socks] (~=2.26)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.15","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"117ae15ab69b17c143547e8bc4b618705fe0aaa75cd0f0c7218fceb6a38688ed","md5":"83ca6678f96a62a6df49f5c076f88e67","sha256":"0f0777b62519cebdb2678fbfb59c7eb96ae770c0a1114cf9653cb1d9d53d43dd"},"downloads":-1,"filename":"changedetection.io-0.39.15-py3-none-any.whl","has_sig":false,"md5_digest":"83ca6678f96a62a6df49f5c076f88e67","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":305111,"upload_time":"2022-06-12T12:07:05","upload_time_iso_8601":"2022-06-12T12:07:05.019989Z","url":"https://files.pythonhosted.org/packages/11/7a/e15ab69b17c143547e8bc4b618705fe0aaa75cd0f0c7218fceb6a38688ed/changedetection.io-0.39.15-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.16":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.16/","requires_dist":["apprise (~=0.9.9)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytz","requests[socks] (~=2.26)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.16","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"bf6aca9d8a531f262f380deec1730cc9ba956202726ee0bae34325bbf3581a70","md5":"589dfd8a15e10ef0cef3fdcfdd62dbaa","sha256":"8e853f0a1f6bbda05efa73b82d436be61f1fa1d1274f9cc23273b15dc61a16b9"},"downloads":-1,"filename":"changedetection.io-0.39.16-py3-none-any.whl","has_sig":false,"md5_digest":"589dfd8a15e10ef0cef3fdcfdd62dbaa","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":308215,"upload_time":"2022-07-05T14:17:27","upload_time_iso_8601":"2022-07-05T14:17:27.067978Z","url":"https://files.pythonhosted.org/packages/bf/6a/ca9d8a531f262f380deec1730cc9ba956202726ee0bae34325bbf3581a70/changedetection.io-0.39.16-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.17":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.17/","requires_dist":["apprise (~=0.9.9)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytz","requests[socks] (~=2.26)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.17","yanked":true,"yanked_reason":"bug in failure detection"},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"10dceda4f2c28575107c2bd250b8aee3c37302e334b56e724f2ab9579f507e3a","md5":"aebf2f0cbc5294a6aad347dadebb7f01","sha256":"ecb41ee9701655fab15aaa7bdf930ec5dbbcb87788ca492acecd073db2542eb6"},"downloads":-1,"filename":"changedetection.io-0.39.17-py3-none-any.whl","has_sig":false,"md5_digest":"aebf2f0cbc5294a6aad347dadebb7f01","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":323773,"upload_time":"2022-07-28T11:09:57","upload_time_iso_8601":"2022-07-28T11:09:57.426034Z","url":"https://files.pythonhosted.org/packages/10/dc/eda4f2c28575107c2bd250b8aee3c37302e334b56e724f2ab9579f507e3a/changedetection.io-0.39.17-py3-none-any.whl","yanked":true,"yanked_reason":"bug in failure detection"}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.17.1":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.17.1/","requires_dist":["apprise (~=0.9.9)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytz","requests[socks] (~=2.26)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.17.1","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"c98c36f6227bd6e841efb220f0bb11718672c2267d1b81608a8170e6b0a9da72","md5":"e41d2768393566d9c0765d3550cad00b","sha256":"4344c14fe200d412dacc26f669cebce81189d7df6d5f5056dec268357924fc7c"},"downloads":-1,"filename":"changedetection.io-0.39.17.1-py3-none-any.whl","has_sig":false,"md5_digest":"e41d2768393566d9c0765d3550cad00b","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":324009,"upload_time":"2022-07-29T08:15:31","upload_time_iso_8601":"2022-07-29T08:15:31.332828Z","url":"https://files.pythonhosted.org/packages/c9/8c/36f6227bd6e841efb220f0bb11718672c2267d1b81608a8170e6b0a9da72/changedetection.io-0.39.17.1-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.17.2":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.17.2/","requires_dist":["apprise (~=0.9.9)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytz","requests[socks] (~=2.26)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.17.2","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"acaef75519c99bfdfad16fe584a9e7d4901ad7b5db5fc766731486964cdb7a86","md5":"3abc0ffa5825092627f2023d7c39115f","sha256":"8856aa4f2e52e12eb79084f26efd83725a2768c86ececd2ddadf5e33aaa51d62"},"downloads":-1,"filename":"changedetection.io-0.39.17.2-py3-none-any.whl","has_sig":false,"md5_digest":"3abc0ffa5825092627f2023d7c39115f","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":275107,"upload_time":"2022-08-05T15:27:09","upload_time_iso_8601":"2022-08-05T15:27:09.494183Z","url":"https://files.pythonhosted.org/packages/ac/ae/f75519c99bfdfad16fe584a9e7d4901ad7b5db5fc766731486964cdb7a86/changedetection.io-0.39.17.2-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.18":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.18/","requires_dist":["apprise (~=1.0.0)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytz","requests[socks] (~=2.26)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.18","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"618f907363267931285f6253967255fdcfd760ea1579358db115b125f0d6b6b5","md5":"ec890d06b15a0f9148fa8a80d89080e8","sha256":"5b374ad385376f32b6ed78ecadebf718bd2d42d834ab7fc9292ba520ec207dd1"},"downloads":-1,"filename":"changedetection.io-0.39.18-py3-none-any.whl","has_sig":false,"md5_digest":"ec890d06b15a0f9148fa8a80d89080e8","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":329800,"upload_time":"2022-08-19T09:40:53","upload_time_iso_8601":"2022-08-19T09:40:53.568170Z","url":"https://files.pythonhosted.org/packages/61/8f/907363267931285f6253967255fdcfd760ea1579358db115b125f0d6b6b5/changedetection.io-0.39.18-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.19":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.19/","requires_dist":["apprise (~=1.0.0)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytz","requests[socks] (~=2.26)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.19","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"9239096e3340633fca3951296f441efd4663605a4d7ac5183f9737d23c87a1f2","md5":"4e13427c0975a691d828bbcb60d95a2b","sha256":"522a63c76fae46b93e4d946b66c1fecf9f4ce07714fe3619748e763cb42478ce"},"downloads":-1,"filename":"changedetection.io-0.39.19-py3-none-any.whl","has_sig":false,"md5_digest":"4e13427c0975a691d828bbcb60d95a2b","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":333759,"upload_time":"2022-09-08T18:18:14","upload_time_iso_8601":"2022-09-08T18:18:14.199292Z","url":"https://files.pythonhosted.org/packages/92/39/096e3340633fca3951296f441efd4663605a4d7ac5183f9737d23c87a1f2/changedetection.io-0.39.19-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.19.1":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.19.1/","requires_dist":["apprise (~=1.0.0)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytz","requests[socks] (~=2.26)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.19.1","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"14db4128e18c9be41f34b51a600896360032279b55736a149fe6b5789f7640af","md5":"cd9e8d0993e93d472f4b6d8f2faf47ab","sha256":"6cb87f67ea845a8301b017df98fe2f1e87abd77d30b41e4581f5a47eaa092fde"},"downloads":-1,"filename":"changedetection.io-0.39.19.1-py3-none-any.whl","has_sig":false,"md5_digest":"cd9e8d0993e93d472f4b6d8f2faf47ab","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":334383,"upload_time":"2022-09-11T07:24:26","upload_time_iso_8601":"2022-09-11T07:24:26.878026Z","url":"https://files.pythonhosted.org/packages/14/db/4128e18c9be41f34b51a600896360032279b55736a149fe6b5789f7640af/changedetection.io-0.39.19.1-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.2":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":"","project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.2/","requires_dist":["apprise (~=0.9)","bs4","chardet (==2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask (~=1.0)","inscriptis (~=1.2)","jsonpath-ng (~=1.5.3)","pytz","requests[socks] (~=2.15)","selenium (~=3.141)","timeago (~=1.0)","urllib3","validators","wtforms (~=2.3.3)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.2","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"ee2d0dc8035e7fde806f48ce0de5ff484b6c948a529d3f7c0b0f758e6ba3259a","md5":"8c4285b7c11499b12cd2277be02b77a8","sha256":"6670fc34abd525baee10732bb7281291f2e2e8788dc039a1e24cd28eca14ae9b"},"downloads":-1,"filename":"changedetection.io-0.39.2-py3-none-any.whl","has_sig":false,"md5_digest":"8c4285b7c11499b12cd2277be02b77a8","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":170278,"upload_time":"2021-10-06T14:11:02","upload_time_iso_8601":"2021-10-06T14:11:02.290729Z","url":"https://files.pythonhosted.org/packages/ee/2d/0dc8035e7fde806f48ce0de5ff484b6c948a529d3f7c0b0f758e6ba3259a/changedetection.io-0.39.2-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.20":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.20/","requires_dist":["apprise (~=1.1.0)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jq (~=1.3.0)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytz","requests[socks] (~=2.26)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.20","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"1946d72e0dc95abdaccb71d428c5bc58fb7770b111b06e0df4c2c967a1d92fc0","md5":"1f349ac7a1505e2db6cf2cfee2b7cddd","sha256":"0114f2a39a0f346d6ba830084fe41684dba7a0938146a24f4cdc618e8aa725d4"},"downloads":-1,"filename":"changedetection.io-0.39.20-py3-none-any.whl","has_sig":false,"md5_digest":"1f349ac7a1505e2db6cf2cfee2b7cddd","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":335235,"upload_time":"2022-10-09T14:16:15","upload_time_iso_8601":"2022-10-09T14:16:15.908585Z","url":"https://files.pythonhosted.org/packages/19/46/d72e0dc95abdaccb71d428c5bc58fb7770b111b06e0df4c2c967a1d92fc0/changedetection.io-0.39.20-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.20.1":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.20.1/","requires_dist":["apprise (~=1.1.0)","brotli (~=1.0)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jq (~=1.3.0)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytz","requests[socks] (~=2.28)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.20.1","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"d08b49817b657e6c9cc1c973be0c424011ac3d21a31a0e0cfb350afb18d5c35f","md5":"ab96e0a3fc754cec68daf481f076b698","sha256":"c0dde70d734776dce04149528dc412de3c921afe58864a313074ee843dfd26a0"},"downloads":-1,"filename":"changedetection.io-0.39.20.1-py3-none-any.whl","has_sig":false,"md5_digest":"ab96e0a3fc754cec68daf481f076b698","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":335344,"upload_time":"2022-10-09T21:07:16","upload_time_iso_8601":"2022-10-09T21:07:16.423737Z","url":"https://files.pythonhosted.org/packages/d0/8b/49817b657e6c9cc1c973be0c424011ac3d21a31a0e0cfb350afb18d5c35f/changedetection.io-0.39.20.1-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.20.2":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.20.2/","requires_dist":["apprise (~=1.1.0)","brotli (~=1.0)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytz","requests[socks] (~=2.28)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.20.2","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"a7f5f33b2b7240d4b4c3c0eb17383e90a2bdf01a9c1dddd4a745f2c8bf8ae3e6","md5":"b348786d36d3a8da211b3e90cbe661f4","sha256":"2d71d6bba16a1f12a3289c1b76ca19a4b906308aeed3eee177813bd4deaa67b6"},"downloads":-1,"filename":"changedetection.io-0.39.20.2-py3-none-any.whl","has_sig":false,"md5_digest":"b348786d36d3a8da211b3e90cbe661f4","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":335670,"upload_time":"2022-10-12T07:54:43","upload_time_iso_8601":"2022-10-12T07:54:43.472436Z","url":"https://files.pythonhosted.org/packages/a7/f5/f33b2b7240d4b4c3c0eb17383e90a2bdf01a9c1dddd4a745f2c8bf8ae3e6/changedetection.io-0.39.20.2-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.20.3":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.20.3/","requires_dist":["apprise (~=1.1.0)","brotli (~=1.0)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytz","requests[socks] (~=2.28)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.20.3","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"7278a9ac049d0e4a38b727b3a859ba09f8a386d8194cbe12de47765bb101b870","md5":"79940afe079271dd67c8171d273caaef","sha256":"7189290f12b96e1a7022bfd18084173fdde1b805ea42228875fa1b6551708520"},"downloads":-1,"filename":"changedetection.io-0.39.20.3-py3-none-any.whl","has_sig":false,"md5_digest":"79940afe079271dd67c8171d273caaef","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":394684,"upload_time":"2022-10-17T15:46:00","upload_time_iso_8601":"2022-10-17T15:46:00.486363Z","url":"https://files.pythonhosted.org/packages/72/78/a9ac049d0e4a38b727b3a859ba09f8a386d8194cbe12de47765bb101b870/changedetection.io-0.39.20.3-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.20.4":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.20.4/","requires_dist":["apprise (~=1.1.0)","brotli (~=1.0)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytz","requests[socks] (~=2.28)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.20.4","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"76e40e499a719a2ec6ed787918c676117f31899fe3939608559a8a296336a3dd","md5":"2d7da9afa35da9fe472205f54867dacd","sha256":"0133b826304218ce7b3a4298e5ee19ac699238dee064de7c224dab2c4673df5b"},"downloads":-1,"filename":"changedetection.io-0.39.20.4-py3-none-any.whl","has_sig":false,"md5_digest":"2d7da9afa35da9fe472205f54867dacd","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":394726,"upload_time":"2022-10-17T16:38:21","upload_time_iso_8601":"2022-10-17T16:38:21.651580Z","url":"https://files.pythonhosted.org/packages/76/e4/0e499a719a2ec6ed787918c676117f31899fe3939608559a8a296336a3dd/changedetection.io-0.39.20.4-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.21":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.21/","requires_dist":["apprise (~=1.1.0)","brotli (~=1.0)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jinja2-time","jinja2 (~=3.1)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytz","requests[socks] (~=2.28)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)","playwright (~=1.26) ; python_version >= \"3.8\" and \"arm\" not in platform_machine and \"aarch\" not in platform_machine","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.21","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"ec8e3219abc1460ffa27518c6d6f86070c1879ffdc823540d2d8aaa10bad0b34","md5":"64cf65049f823710338c10cd8f555682","sha256":"dca3239c4a8c00e75fd2816081cbbaccffcbffbb9b84e68aed32d0d74cbb34f7"},"downloads":-1,"filename":"changedetection.io-0.39.21-py3-none-any.whl","has_sig":false,"md5_digest":"64cf65049f823710338c10cd8f555682","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":345610,"upload_time":"2022-11-02T14:14:19","upload_time_iso_8601":"2022-11-02T14:14:19.870848Z","url":"https://files.pythonhosted.org/packages/ec/8e/3219abc1460ffa27518c6d6f86070c1879ffdc823540d2d8aaa10bad0b34/changedetection.io-0.39.21-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.21.1":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.21.1/","requires_dist":["apprise (~=1.1.0)","brotli (~=1.0)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jinja2-time","jinja2 (~=3.1)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytz","requests[socks] (~=2.28)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.21.1","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"e36022cfa11e1f3217fb48f300c076fb271155c7c59c49fbcdf7f306b1d72998","md5":"ea522ba0b356d150670d42ae195ef405","sha256":"0e45da42d7d2a2e8a8743f61a0ca3bc194d915970a4ee0225ca30668174fc301"},"downloads":-1,"filename":"changedetection.io-0.39.21.1-py3-none-any.whl","has_sig":false,"md5_digest":"ea522ba0b356d150670d42ae195ef405","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":345616,"upload_time":"2022-11-02T22:49:15","upload_time_iso_8601":"2022-11-02T22:49:15.351272Z","url":"https://files.pythonhosted.org/packages/e3/60/22cfa11e1f3217fb48f300c076fb271155c7c59c49fbcdf7f306b1d72998/changedetection.io-0.39.21.1-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.22":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.22/","requires_dist":["apprise (~=1.2.0)","brotli (~=1.0)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jinja2-time","jinja2 (~=3.1)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pillow","pytz","requests[socks] (~=2.28)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.22","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"fa5b311c6dbb91dfe24d05791eb73aa72fa993726fa10e8873eff8e1b975fdbd","md5":"30d234e5a214be673e00799deee1fc7c","sha256":"8f12ff7690eeb672a844be26296261ca9c58bbf3797482338f6fb01268b39f9e"},"downloads":-1,"filename":"changedetection.io-0.39.22-py3-none-any.whl","has_sig":false,"md5_digest":"30d234e5a214be673e00799deee1fc7c","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":398494,"upload_time":"2022-11-20T15:38:46","upload_time_iso_8601":"2022-11-20T15:38:46.354576Z","url":"https://files.pythonhosted.org/packages/fa/5b/311c6dbb91dfe24d05791eb73aa72fa993726fa10e8873eff8e1b975fdbd/changedetection.io-0.39.22-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.22.1":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.22.1/","requires_dist":["apprise (~=1.2.0)","brotli (~=1.0)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jinja2-time","jinja2 (~=3.1)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pillow","pytz","requests[socks] (~=2.28)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.22.1","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"5cf53718de3109f5c1dc38a892693dca103ecb1517d4f1aa4eb6536c294d8a92","md5":"7874b93082f1530fdda510bbda9b386f","sha256":"62dfefdc29a680463b3f0f7417056c2af31c77a5545604bb6ab8fc987d0c46a3"},"downloads":-1,"filename":"changedetection.io-0.39.22.1-py3-none-any.whl","has_sig":false,"md5_digest":"7874b93082f1530fdda510bbda9b386f","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":398761,"upload_time":"2022-11-22T21:42:42","upload_time_iso_8601":"2022-11-22T21:42:42.268633Z","url":"https://files.pythonhosted.org/packages/5c/f5/3718de3109f5c1dc38a892693dca103ecb1517d4f1aa4eb6536c294d8a92/changedetection.io-0.39.22.1-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.3":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":"","project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.3/","requires_dist":["apprise (~=0.9)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask (~=1.0)","inscriptis (~=1.2)","jsonpath-ng (~=1.5.3)","pytz","requests[socks] (~=2.26)","selenium (~=3.141)","timeago (~=1.0)","urllib3 (>1.26)","validators","wtforms (~=2.3.3)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.3","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"fe8d901687123c030176aac6d161434a739fa137a69107435e4c54520b58e2fd","md5":"09a20eacba1fcc73c4a104164aedbce3","sha256":"07bc7fde5ab66709ba56792c0b81afe05b5428af6db8efe63b84f35730b75886"},"downloads":-1,"filename":"changedetection.io-0.39.3-py3-none-any.whl","has_sig":false,"md5_digest":"09a20eacba1fcc73c4a104164aedbce3","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":170334,"upload_time":"2021-10-29T19:44:04","upload_time_iso_8601":"2021-10-29T19:44:04.904332Z","url":"https://files.pythonhosted.org/packages/fe/8d/901687123c030176aac6d161434a739fa137a69107435e4c54520b58e2fd/changedetection.io-0.39.3-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.4":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":"","project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.4/","requires_dist":["apprise (~=0.9)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask (~=1.0)","inscriptis (~=1.2)","jsonpath-ng (~=1.5.3)","pytz","requests[socks] (~=2.26)","selenium (~=3.141)","timeago (~=1.0)","urllib3 (>1.26)","validators","wtforms (~=2.3.3)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.4","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"0d28b167acc81c2c3be1517f73bedbdb13d18c45d9dd7c30c792aac278f16c21","md5":"b158255ab9fd39816495020bb1796993","sha256":"e017083c8b31940692c3e61375ffca82aba58909722a0a227c758a71043f63a6"},"downloads":-1,"filename":"changedetection.io-0.39.4-py3-none-any.whl","has_sig":false,"md5_digest":"b158255ab9fd39816495020bb1796993","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":171746,"upload_time":"2021-12-03T09:57:35","upload_time_iso_8601":"2021-12-03T09:57:35.962145Z","url":"https://files.pythonhosted.org/packages/0d/28/b167acc81c2c3be1517f73bedbdb13d18c45d9dd7c30c792aac278f16c21/changedetection.io-0.39.4-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.5":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":"","project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.5/","requires_dist":["apprise (~=0.9)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask (~=2.0)","inscriptis (~=1.2)","jsonpath-ng (~=1.5.3)","paho-mqtt","pytz","requests[socks] (~=2.26)","selenium (~=3.141)","timeago (~=1.0)","urllib3 (>1.26)","validators","wtforms (~=2.3.3)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.5","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"c84a872dcc2d83dd80a7500158f97a9fb112549d7ae96b2264f863b4146c8e7e","md5":"529fc76725de708492cb43f912aa939c","sha256":"c0ef2edcee78e464dda2d4bd37c77990a181db88245bf0614e141b68bb40e6a9"},"downloads":-1,"filename":"changedetection.io-0.39.5-py3-none-any.whl","has_sig":false,"md5_digest":"529fc76725de708492cb43f912aa939c","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":176291,"upload_time":"2021-12-28T16:11:16","upload_time_iso_8601":"2021-12-28T16:11:16.557517Z","url":"https://files.pythonhosted.org/packages/c8/4a/872dcc2d83dd80a7500158f97a9fb112549d7ae96b2264f863b4146c8e7e/changedetection.io-0.39.5-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.6":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":"","project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.6/","requires_dist":["apprise (~=0.9)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask (~=2.0)","inscriptis (~=1.2)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytz","requests[socks] (~=2.26)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","wtforms (~=2.3.3)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.6","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"c371d1909ed85e0d5ad4c172731d28a502b48fd6518c7641e2bb07c9b1d4e97e","md5":"9fbcd0951a9490dcf00fa008a8df0724","sha256":"dfd3794b774754ec6496bef48f515855a4c0f904f01415eeeeec0ceaa6dff445"},"downloads":-1,"filename":"changedetection.io-0.39.6-py3-none-any.whl","has_sig":false,"md5_digest":"9fbcd0951a9490dcf00fa008a8df0724","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":177234,"upload_time":"2022-01-05T18:18:24","upload_time_iso_8601":"2022-01-05T18:18:24.144442Z","url":"https://files.pythonhosted.org/packages/c3/71/d1909ed85e0d5ad4c172731d28a502b48fd6518c7641e2bb07c9b1d4e97e/changedetection.io-0.39.6-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.7":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":"","project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.7/","requires_dist":["apprise (~=0.9.6)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask (~=2.0)","inscriptis (~=1.2)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytz","requests[socks] (~=2.26)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","wtforms (~=2.3.3)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.7","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"b899987c7968a62b8f89094c5c40b9004f1f9a9531be9ed46e71a168f354b436","md5":"2cfc654680c48f207729ebc829595e18","sha256":"cd98cfbd989830da254ff8d457eb47a2319813bc239b4f4d148032209b64c7bf"},"downloads":-1,"filename":"changedetection.io-0.39.7-py3-none-any.whl","has_sig":false,"md5_digest":"2cfc654680c48f207729ebc829595e18","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":176511,"upload_time":"2022-01-21T11:01:53","upload_time_iso_8601":"2022-01-21T11:01:53.327172Z","url":"https://files.pythonhosted.org/packages/b8/99/987c7968a62b8f89094c5c40b9004f1f9a9531be9ed46e71a168f354b436/changedetection.io-0.39.7-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.8":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":"","project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.8/","requires_dist":["apprise (~=0.9.6)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask (~=2.0)","inscriptis (~=1.2)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytest-flask (~=1.2)","pytest (~=6.2)","pytz","requests[socks] (~=2.26)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","wtforms (~=2.3.3)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.8","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"58014ecc34ddb7122f82c53a811d90775d67802402d85fdcf8cb86e7fc61e752","md5":"05cc3411c52a15ff30d885ac3bbd2fba","sha256":"d80ac52ffcf7ad1f2b061bdb874b37eb5f8c2f6f1a851cd743207de4e62b0946"},"downloads":-1,"filename":"changedetection.io-0.39.8-py3-none-any.whl","has_sig":false,"md5_digest":"05cc3411c52a15ff30d885ac3bbd2fba","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":178397,"upload_time":"2022-02-08T21:55:31","upload_time_iso_8601":"2022-02-08T21:55:31.911244Z","url":"https://files.pythonhosted.org/packages/58/01/4ecc34ddb7122f82c53a811d90775d67802402d85fdcf8cb86e7fc61e752/changedetection.io-0.39.8-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.39.9":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":"","project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.39.9/","requires_dist":["apprise (~=0.9.6)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-login (~=0.5)","flask (~=2.0)","inscriptis (~=1.2)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pytest-flask (~=1.2)","pytest (~=6.2)","pytz","requests[socks] (~=2.26)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","wtforms (~=2.3.3)"],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.39.9","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"899e0c44e42a48566e045afc33813beec5c00a1a2e3d3440037737d68448e85e","md5":"c63e9cc55fbf9f2c5dad446d917470cc","sha256":"c516d2af8a230a1180349a37618498569c0b2749793b95f472602af7897d46d4"},"downloads":-1,"filename":"changedetection.io-0.39.9-py3-none-any.whl","has_sig":false,"md5_digest":"c63e9cc55fbf9f2c5dad446d917470cc","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":183485,"upload_time":"2022-03-04T12:19:20","upload_time_iso_8601":"2022-03-04T12:19:20.194764Z","url":"https://files.pythonhosted.org/packages/89/9e/0c44e42a48566e045afc33813beec5c00a1a2e3d3440037737d68448e85e/changedetection.io-0.39.9-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.40.0":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.40.0/","requires_dist":["apprise (~=1.2.0)","brotli (~=1.0)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-compress","flask-login (~=0.5)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jinja2-time","jinja2 (~=3.1)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pillow","pytz","requests[socks] (~=2.28)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.40.0","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"fe6ef80bba2ec658e538e5ab3b937078e6f31e5972da310c84f857cac535d682","md5":"ac80d04724b1455e7a50097e109c5e20","sha256":"42f0d93ce1e011b30597b07bb527493ee65ee538585449534eadf8bc640c08f2"},"downloads":-1,"filename":"changedetection.io-0.40.0-py3-none-any.whl","has_sig":false,"md5_digest":"ac80d04724b1455e7a50097e109c5e20","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":576109,"upload_time":"2022-12-08T20:00:08","upload_time_iso_8601":"2022-12-08T20:00:08.273561Z","url":"https://files.pythonhosted.org/packages/fe/6e/f80bba2ec658e538e5ab3b937078e6f31e5972da310c84f857cac535d682/changedetection.io-0.40.0-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.40.0.1":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.40.0.1/","requires_dist":["apprise (~=1.2.0)","brotli (~=1.0)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-compress","flask-login (~=0.5)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jinja2-time","jinja2 (~=3.1)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pillow","pytz","requests[socks] (~=2.28)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.40.0.1","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"24587df5b1734a7e9ff3b88c17631eb0cc8dfacc06ca27b74d344af4eb44dda7","md5":"a3ca01b13b6daf307569c35631e9a7cc","sha256":"276b95b118ecf387cd75726f7c21b6d51d0d2d10f422dd20b3dbc920af3811a1"},"downloads":-1,"filename":"changedetection.io-0.40.0.1-py3-none-any.whl","has_sig":false,"md5_digest":"a3ca01b13b6daf307569c35631e9a7cc","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":584815,"upload_time":"2022-12-08T20:56:02","upload_time_iso_8601":"2022-12-08T20:56:02.244580Z","url":"https://files.pythonhosted.org/packages/24/58/7df5b1734a7e9ff3b88c17631eb0cc8dfacc06ca27b74d344af4eb44dda7/changedetection.io-0.40.0.1-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.40.0.2":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.40.0.2/","requires_dist":["apprise (~=1.2.0)","brotli (~=1.0)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-compress","flask-login (~=0.5)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jinja2-time","jinja2 (~=3.1)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pillow","pytz","requests[socks] (~=2.28)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.40.0.2","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"c32b25dc8841334f48be51d0924fc9368a825efd45a49c4e4d5065316806b2d7","md5":"9ef91d54a525a99f4f58be9c49e66a49","sha256":"98bf9a92a70221a29a8605ea3f6d8e4772b6feafbab713318427b7b929d5bd5d"},"downloads":-1,"filename":"changedetection.io-0.40.0.2-py3-none-any.whl","has_sig":false,"md5_digest":"9ef91d54a525a99f4f58be9c49e66a49","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":584919,"upload_time":"2022-12-08T21:39:13","upload_time_iso_8601":"2022-12-08T21:39:13.664506Z","url":"https://files.pythonhosted.org/packages/c3/2b/25dc8841334f48be51d0924fc9368a825efd45a49c4e4d5065316806b2d7/changedetection.io-0.40.0.2-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.40.0.3":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.40.0.3/","requires_dist":["apprise (~=1.2.0)","brotli (~=1.0)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-compress","flask-login (~=0.5)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jinja2-time","jinja2 (~=3.1)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pillow","pytz","requests[socks] (~=2.28)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.40.0.3","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"68e9bfd6ce9ecd4248de68ef3d74d949c810bf131fc528804adbbf894f8fda4d","md5":"8a413bedcc1e3a234efa455479e42dcd","sha256":"f4e0956c28e4395be1527860a4df0731d055f1c12912d684c16d6aa301e2e406"},"downloads":-1,"filename":"changedetection.io-0.40.0.3-py3-none-any.whl","has_sig":false,"md5_digest":"8a413bedcc1e3a234efa455479e42dcd","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":560738,"upload_time":"2022-12-19T11:43:41","upload_time_iso_8601":"2022-12-19T11:43:41.917807Z","url":"https://files.pythonhosted.org/packages/68/e9/bfd6ce9ecd4248de68ef3d74d949c810bf131fc528804adbbf894f8fda4d/changedetection.io-0.40.0.3-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.40.0.4":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.40.0.4/","requires_dist":["apprise (~=1.2.0)","brotli (~=1.0)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-compress","flask-login (~=0.5)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jinja2-time","jinja2 (~=3.1)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pillow","pytest-flask (~=1.2)","pytest (~=6.2)","pytz","requests[socks] (~=2.28)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.40.0.4","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"6f9939fb529752a13147726deed8996ac233cc08e2f2e46c63313f92cac2d715","md5":"8161976e40d368c69471a571fa7eaff3","sha256":"e349976290ff4b32b60134a9a71448aec506ea4de52ca607dd48923619a32923"},"downloads":-1,"filename":"changedetection.io-0.40.0.4-py3-none-any.whl","has_sig":false,"md5_digest":"8161976e40d368c69471a571fa7eaff3","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":575950,"upload_time":"2022-12-25T17:30:32","upload_time_iso_8601":"2022-12-25T17:30:32.602434Z","url":"https://files.pythonhosted.org/packages/6f/99/39fb529752a13147726deed8996ac233cc08e2f2e46c63313f92cac2d715/changedetection.io-0.40.0.4-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.40.1.0":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.40.1.0/","requires_dist":["apprise (~=1.2.1)","brotli (~=1.0)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","dnspython (<2.3.0)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-compress","flask-login (~=0.5)","flask-expects-json (~=1.7)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jinja2-time","jinja2 (~=3.1)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pillow","pytest-flask (~=1.2)","pytest (~=6.2)","pytz","requests[socks] (~=2.28)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.40.1.0","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"4f57496676b18dac11a23e8e8d5b2cca17d57516323a116ae386305e16ce7545","md5":"5454addce646f4a8be455e8dce2c89cc","sha256":"1f68d523e5f0c8801a4eedc2154f564c4111a3b181cc770bb2d58fdd39b99bac"},"downloads":-1,"filename":"changedetection.io-0.40.1.0-py3-none-any.whl","has_sig":false,"md5_digest":"5454addce646f4a8be455e8dce2c89cc","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":554864,"upload_time":"2023-01-21T14:39:28","upload_time_iso_8601":"2023-01-21T14:39:28.365850Z","url":"https://files.pythonhosted.org/packages/4f/57/496676b18dac11a23e8e8d5b2cca17d57516323a116ae386305e16ce7545/changedetection.io-0.40.1.0-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before v0.40.1.1 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.1.1"],"id":"PYSEC-2023-10","link":"https://osv.dev/vulnerability/PYSEC-2023-10","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.40.1.1":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.40.1.1/","requires_dist":["apprise (~=1.2.1)","brotli (~=1.0)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","dnspython (<2.3.0)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-compress","flask-login (~=0.5)","flask-expects-json (~=1.7)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jinja2-time","jinja2 (~=3.1)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pillow","pytest-flask (~=1.2)","pytest (~=6.2)","pytz","requests[socks] (~=2.28)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.40.1.1","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"06201a6c2369b2419c299ba7b55e8021f11470313a9e2fdb06f3a4faf8edccd0","md5":"35be009da5fd789d7195f6a758def680","sha256":"a14c5335016cb79a43007cb04cb4715e605bf60d84bc76f3f52382268013ba5e"},"downloads":-1,"filename":"changedetection.io-0.40.1.1-py3-none-any.whl","has_sig":false,"md5_digest":"35be009da5fd789d7195f6a758def680","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":554917,"upload_time":"2023-01-22T12:04:32","upload_time_iso_8601":"2023-01-22T12:04:32.277423Z","url":"https://files.pythonhosted.org/packages/06/20/1a6c2369b2419c299ba7b55e8021f11470313a9e2fdb06f3a4faf8edccd0/changedetection.io-0.40.1.1-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2023-24769"],"details":"Changedetection.io before 0.40.2 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the main page. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the URL parameter under the \"Add a new change detection watch\" function.","fixed_in":["0.40.2"],"id":"GHSA-68wj-c2jw-5pp9","link":"https://osv.dev/vulnerability/GHSA-68wj-c2jw-5pp9","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.40.2":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.40.2/","requires_dist":["apprise (~=1.2.1)","brotli (~=1.0)","bs4","chardet (>2.3.0)","cryptography (~=3.4)","dnspython (<2.3.0)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-compress","flask-login (~=0.5)","flask-expects-json (~=1.7)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jinja2-time","jinja2 (~=3.1)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pillow","pytest-flask (~=1.2)","pytest (~=6.2)","pytz","requests[socks] (~=2.28)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.40.2","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"622b94ad080073eba5ca40d187807bdce5e84db08bd0a92bd61e2d108228d362","md5":"e995f9fad87544ccde8b67dcd1a29184","sha256":"e8201a15f0fecafb16d3fda3aaa68112a9c0b8630f647ce89e9780a6e70b068c"},"downloads":-1,"filename":"changedetection.io-0.40.2-py3-none-any.whl","has_sig":false,"md5_digest":"e995f9fad87544ccde8b67dcd1a29184","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":582921,"upload_time":"2023-02-03T18:21:21","upload_time_iso_8601":"2023-02-03T18:21:21.848746Z","url":"https://files.pythonhosted.org/packages/62/2b/94ad080073eba5ca40d187807bdce5e84db08bd0a92bd61e2d108228d362/changedetection.io-0.40.2-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.40.3":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.40.3/","requires_dist":["apprise (~=1.3.0)","beautifulsoup4","brotli (~=1.0)","chardet (>2.3.0)","cryptography (~=3.4)","dnspython (<2.3.0)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-compress","flask-login (~=0.5)","flask-expects-json (~=1.7)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jinja2-time","jinja2 (~=3.1)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pillow","pytest-flask (~=1.2)","pytest (~=6.2)","pytz","requests[socks] (~=2.28)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.40.3","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"e8ee1d8467e8daac5482602be16acdc7ea3a37b31c4b3a22ca382533851ef772","md5":"4d60280215df4a16d309c4a5b266c31e","sha256":"b0a99172e2d87a98a4786c4c5db8d8437d0ee9bac36bcfef62af37c4e1b051ee"},"downloads":-1,"filename":"changedetection.io-0.40.3-py3-none-any.whl","has_sig":false,"md5_digest":"4d60280215df4a16d309c4a5b266c31e","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":583247,"upload_time":"2023-03-01T07:22:39","upload_time_iso_8601":"2023-03-01T07:22:39.211017Z","url":"https://files.pythonhosted.org/packages/e8/ee/1d8467e8daac5482602be16acdc7ea3a37b31c4b3a22ca382533851ef772/changedetection.io-0.40.3-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.41":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.41/","requires_dist":["apprise (~=1.3.0)","beautifulsoup4","brotli (~=1.0)","chardet (>2.3.0)","cryptography (~=3.4)","dnspython (<2.3.0)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-compress","flask-login (~=0.5)","flask-expects-json (~=1.7)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jinja2-time","jinja2 (~=3.1)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pillow","pytest-flask (~=1.2)","pytest (~=7.2)","pytz","requests[socks] (~=2.28)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.41","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"b882d589b0b3fbe330961aa33e36ebaa994a39c032e543068aacfc77c0dfc391","md5":"4899c4ee59dfa30c052b56cc138e7ff9","sha256":"1c7192d913520f9e867651f5eaedc91a295a7a4177af70410c5c268a7990ae6f"},"downloads":-1,"filename":"changedetection.io-0.41-py3-none-any.whl","has_sig":false,"md5_digest":"4899c4ee59dfa30c052b56cc138e7ff9","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":585046,"upload_time":"2023-03-21T19:33:14","upload_time_iso_8601":"2023-03-21T19:33:14.914507Z","url":"https://files.pythonhosted.org/packages/b8/82/d589b0b3fbe330961aa33e36ebaa994a39c032e543068aacfc77c0dfc391/changedetection.io-0.41-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.41.1":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.41.1/","requires_dist":["apprise (~=1.3.0)","beautifulsoup4","brotli (~=1.0)","chardet (>2.3.0)","cryptography (~=3.4)","dnspython (<2.3.0)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-compress","flask-login (~=0.5)","flask-expects-json (~=1.7)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jinja2-time","jinja2 (~=3.1)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pillow","pytest-flask (~=1.2)","pytest (~=7.2)","pytz","requests[socks] (~=2.28)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.41.1","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"03fee79e6dcc2b20d9ac6cca4fad7fcae877752b80da8bb185cb73eeadc848c3","md5":"d84051b0a25cf8b8088b36607ae7c534","sha256":"c1037474c27b665f08e7fa7d01c40b0c70c76f41b7455790691e21575cf6a900"},"downloads":-1,"filename":"changedetection.io-0.41.1-py3-none-any.whl","has_sig":false,"md5_digest":"d84051b0a25cf8b8088b36607ae7c534","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":594375,"upload_time":"2023-03-21T22:16:46","upload_time_iso_8601":"2023-03-21T22:16:46.216575Z","url":"https://files.pythonhosted.org/packages/03/fe/e79e6dcc2b20d9ac6cca4fad7fcae877752b80da8bb185cb73eeadc848c3/changedetection.io-0.41.1-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.42":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.42/","requires_dist":["eventlet (>=0.31.0)","feedgen (~=0.9)","flask-compress","flask-login (~=0.5)","flask-paginate","flask-expects-json (~=1.7)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","pytz","timeago (~=1.0)","validators","brotli (~=1.0)","requests[socks] (~=2.28)","urllib3 (>1.26)","chardet (>2.3.0)","wtforms (~=3.0)","jsonpath-ng (~=1.5.3)","dnspython (<2.3.0)","apprise (~=1.3.0)","paho-mqtt","cryptography (~=3.4)","beautifulsoup4","lxml","selenium (~=4.1.0)","werkzeug (~=2.0.0)","jinja2 (~=3.1)","jinja2-time","pillow","pytest (~=7.2)","pytest-flask (~=1.2)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.42","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"b732485a3bec1847aa5a31654b27a5afbca9f6c37e834b1dc3e743e09b5b4068","md5":"880c303f3c2853c92e7be562ce1dc0d6","sha256":"c80a66ee8c666d6fed392eaba88590ae2363319f782d31561747eb320f3deeb6"},"downloads":-1,"filename":"changedetection.io-0.42-py3-none-any.whl","has_sig":false,"md5_digest":"880c303f3c2853c92e7be562ce1dc0d6","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":604502,"upload_time":"2023-05-18T20:14:21","upload_time_iso_8601":"2023-05-18T20:14:21.488702Z","url":"https://files.pythonhosted.org/packages/b7/32/485a3bec1847aa5a31654b27a5afbca9f6c37e834b1dc3e743e09b5b4068/changedetection.io-0.42-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.42.1":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.42.1/","requires_dist":["eventlet (>=0.31.0)","feedgen (~=0.9)","flask-compress","flask-login (~=0.5)","flask-paginate","flask-expects-json (~=1.7)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","pytz","timeago (~=1.0)","validators","brotli (~=1.0)","requests[socks] (~=2.28)","urllib3 (>1.26)","chardet (>2.3.0)","wtforms (~=3.0)","jsonpath-ng (~=1.5.3)","dnspython (<2.3.0)","apprise (~=1.3.0)","paho-mqtt","cryptography (~=3.4)","beautifulsoup4","lxml","selenium (~=4.1.0)","werkzeug (~=2.0.0)","jinja2 (~=3.1)","jinja2-time","pillow","pytest (~=7.2)","pytest-flask (~=1.2)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.42.1","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"e8b4324daa51fc9e54fe52e12e1df7f85f8e7384484050bb87d162768e24e7e1","md5":"6647838a2b69a34643f84df9c05d54d3","sha256":"1a14649dd72ed8f4434a6cf6f267656c72571230085d4747d1f6e04ebcf1a08f"},"downloads":-1,"filename":"changedetection.io-0.42.1-py3-none-any.whl","has_sig":false,"md5_digest":"6647838a2b69a34643f84df9c05d54d3","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":604547,"upload_time":"2023-05-21T12:20:56","upload_time_iso_8601":"2023-05-21T12:20:56.184584Z","url":"https://files.pythonhosted.org/packages/e8/b4/324daa51fc9e54fe52e12e1df7f85f8e7384484050bb87d162768e24e7e1/changedetection.io-0.42.1-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.42.2":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.42.2/","requires_dist":["eventlet (>=0.31.0)","feedgen (~=0.9)","flask-compress","flask-login (~=0.5)","flask-paginate","flask-expects-json (~=1.7)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","pytz","timeago (~=1.0)","validators","brotli (~=1.0)","requests[socks] (~=2.28)","urllib3 (>1.26)","chardet (>2.3.0)","wtforms (~=3.0)","jsonpath-ng (~=1.5.3)","dnspython (<2.3.0)","apprise (~=1.3.0)","paho-mqtt","cryptography (~=3.4)","beautifulsoup4","lxml","selenium (~=4.1.0)","werkzeug (~=2.0.0)","jinja2 (~=3.1)","jinja2-time","pillow","pytest (~=7.2)","pytest-flask (~=1.2)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.42.2","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"8d044e1273e9d3f8424687cc511e0d0ed47bb7e5310e1125d0f05fdb8758eefa","md5":"a7310da59734e6eb768a01f7b4dac8fb","sha256":"56720a3c120c02f71ecbd73bafedadeac5f27713946003d8a1757f993c73bcb1"},"downloads":-1,"filename":"changedetection.io-0.42.2-py3-none-any.whl","has_sig":false,"md5_digest":"a7310da59734e6eb768a01f7b4dac8fb","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":605961,"upload_time":"2023-05-25T14:48:39","upload_time_iso_8601":"2023-05-25T14:48:39.079678Z","url":"https://files.pythonhosted.org/packages/8d/04/4e1273e9d3f8424687cc511e0d0ed47bb7e5310e1125d0f05fdb8758eefa/changedetection.io-0.42.2-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.42.3":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.42.3/","requires_dist":["eventlet (>=0.31.0)","feedgen (~=0.9)","flask-compress","flask-login (~=0.5)","flask-paginate","flask-expects-json (~=1.7)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","pytz","timeago (~=1.0)","validators","brotli (~=1.0)","requests[socks] (~=2.28)","urllib3 (>1.26)","chardet (>2.3.0)","wtforms (~=3.0)","jsonpath-ng (~=1.5.3)","dnspython (<2.3.0)","apprise (~=1.3.0)","paho-mqtt","cryptography (~=3.4)","beautifulsoup4","lxml","selenium (~=4.1.0)","werkzeug (~=2.0.0)","jinja2 (~=3.1)","jinja2-time","pillow","pytest (~=7.2)","pytest-flask (~=1.2)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.42.3","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"6cc6d91a2403bf5d1bde0b15cbde95be0dcb7a39f9b6d72f1a41355f5d4a0061","md5":"29d69486b7c621c082304a618b459871","sha256":"5a529d4a51a0699254dea52eaf6ac9c85f3dd72010fe20609d85d4c2e2f88cf5"},"downloads":-1,"filename":"changedetection.io-0.42.3-py3-none-any.whl","has_sig":false,"md5_digest":"29d69486b7c621c082304a618b459871","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":606859,"upload_time":"2023-06-12T13:31:14","upload_time_iso_8601":"2023-06-12T13:31:14.536303Z","url":"https://files.pythonhosted.org/packages/6c/c6/d91a2403bf5d1bde0b15cbde95be0dcb7a39f9b6d72f1a41355f5d4a0061/changedetection.io-0.42.3-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.43.1":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.43.1/","requires_dist":["eventlet (>=0.31.0)","feedgen (~=0.9)","flask-compress","flask-login (~=0.5)","flask-paginate","flask-expects-json (~=1.7)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","pytz","timeago (~=1.0)","validators","brotli (~=1.0)","requests[socks] (~=2.28)","urllib3 (>1.26)","chardet (>2.3.0)","wtforms (~=3.0)","jsonpath-ng (~=1.5.3)","dnspython (<2.3.0)","apprise (~=1.3.0)","paho-mqtt","cryptography (~=3.4)","beautifulsoup4","lxml","selenium (~=4.1.0)","werkzeug (~=2.0.0)","jinja2 (~=3.1)","jinja2-time","pillow","pytest (~=7.2)","pytest-flask (~=1.2)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.43.1","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"278d0fb41240be9268e79776bcc96258aa40cbadf6d6f8405b2c6590fadbaf72","md5":"3c13cc0c7751a77d0283a14582b3f5d2","sha256":"635cb30207044016a6570b5b4f1aae00fa53bf1846e66fed60380394af15c4dc"},"downloads":-1,"filename":"changedetection.io-0.43.1-py3-none-any.whl","has_sig":false,"md5_digest":"3c13cc0c7751a77d0283a14582b3f5d2","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":618757,"upload_time":"2023-06-27T16:30:18","upload_time_iso_8601":"2023-06-27T16:30:18.652696Z","url":"https://files.pythonhosted.org/packages/27/8d/0fb41240be9268e79776bcc96258aa40cbadf6d6f8405b2c6590fadbaf72/changedetection.io-0.43.1-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.43.2":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.43.2/","requires_dist":["eventlet (>=0.31.0)","feedgen (~=0.9)","flask-compress","flask-login (~=0.5)","flask-paginate","flask-expects-json (~=1.7)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","pytz","timeago (~=1.0)","validators","brotli (~=1.0)","requests[socks] (~=2.28)","urllib3 (>1.26)","chardet (>2.3.0)","wtforms (~=3.0)","jsonpath-ng (~=1.5.3)","dnspython (<2.3.0)","apprise (~=1.3.0)","paho-mqtt","cryptography (~=3.4)","beautifulsoup4","lxml","selenium (~=4.1.0)","werkzeug (~=2.0.0)","jinja2 (~=3.1)","jinja2-time","pillow","pytest (~=7.2)","pytest-flask (~=1.2)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.43.2","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"0a7415f4a2cab6758aebad0942fd371f62c75f298bd9e4d3430fa351d6b767ab","md5":"bd17229b025c4a8c82aa8a728fd7783e","sha256":"e985ee5ab82652e38bd15c59d5bc31fe4e5475c4c283e048cf27e72b301e945c"},"downloads":-1,"filename":"changedetection.io-0.43.2-py3-none-any.whl","has_sig":false,"md5_digest":"bd17229b025c4a8c82aa8a728fd7783e","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":621534,"upload_time":"2023-06-30T21:01:24","upload_time_iso_8601":"2023-06-30T21:01:24.239016Z","url":"https://files.pythonhosted.org/packages/0a/74/15f4a2cab6758aebad0942fd371f62c75f298bd9e4d3430fa351d6b767ab/changedetection.io-0.43.2-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.44":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.44/","requires_dist":["apprise (~=1.4.5)","beautifulsoup4","brotli (~=1.0)","chardet (>2.3.0)","cryptography (~=3.4)","dnspython (<2.3.0)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-compress","flask-login (~=0.5)","flask-paginate","flask-expects-json (~=1.7)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jinja2-time","jinja2 (~=3.1)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pillow","pytest-flask (~=1.2)","pytest (~=7.2)","pytz","requests[socks] (~=2.28)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.44","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"1dc4a0fcab9ee5ab2d335d632a1f184ed21c7548cf5e4ec60e48bfd1e14e519c","md5":"47e8b67429f01179adb5e63a67d52d5d","sha256":"f98f3ff52ae56c1b41fcbf6ab311bbe00935e96a521ee728cfb07c2f4b1fd354"},"downloads":-1,"filename":"changedetection.io-0.44-py3-none-any.whl","has_sig":false,"md5_digest":"47e8b67429f01179adb5e63a67d52d5d","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":624904,"upload_time":"2023-07-18T09:39:12","upload_time_iso_8601":"2023-07-18T09:39:12.871579Z","url":"https://files.pythonhosted.org/packages/1d/c4/a0fcab9ee5ab2d335d632a1f184ed21c7548cf5e4ec60e48bfd1e14e519c/changedetection.io-0.44-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.44.1":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.44.1/","requires_dist":["apprise (~=1.4.5)","beautifulsoup4","brotli (~=1.0)","chardet (>2.3.0)","cryptography (~=3.4)","dnspython (<2.3.0)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-compress","flask-login (~=0.5)","flask-paginate","flask-expects-json (~=1.7)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jinja2-time","jinja2 (~=3.1)","jsonpath-ng (~=1.5.3)","lxml","paho-mqtt","pillow","pytest-flask (~=1.2)","pytest (~=7.2)","pytz","requests[socks] (~=2.28)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators","werkzeug (~=2.0.0)","wtforms (~=3.0)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.44.1","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"e7460737912fd8e04bd5edeb8dc9f2457d375c6da237d4ed328f4e17d2b259c8","md5":"b99d91f40159525192a75c81bd57e64f","sha256":"79cca9d8adbcc086429f41937b32c6aec52e24e64da4c1532a47424e457e3027"},"downloads":-1,"filename":"changedetection.io-0.44.1-py3-none-any.whl","has_sig":false,"md5_digest":"b99d91f40159525192a75c81bd57e64f","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":625290,"upload_time":"2023-08-02T06:56:28","upload_time_iso_8601":"2023-08-02T06:56:28.183409Z","url":"https://files.pythonhosted.org/packages/e7/46/0737912fd8e04bd5edeb8dc9f2457d375c6da237d4ed328f4e17d2b259c8/changedetection.io-0.44.1-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45/","requires_dist":["apprise (~=1.4.5)","beautifulsoup4","brotli (~=1.0)","chardet (>2.3.0)","cryptography (~=3.4)","dnspython (<2.3.0)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-compress","flask-login (~=0.5)","flask-paginate","flask-expects-json (~=1.7)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jinja2-time","jinja2 (~=3.1)","jsonpath-ng (~=1.5.3)","jsonschema (==4.17.3)","lxml","paho-mqtt","pillow","pytest-flask (~=1.2)","pytest (~=7.2)","pytz","requests[socks] (~=2.28)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators (~=0.21)","werkzeug (~=2.0.0)","wtforms (~=3.0)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.45","yanked":true,"yanked_reason":"bad UI html"},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"765ce218ad83d0d211572f9bab8540c61ed5ecdb4b2eddbf2475dd44bad7ed38","md5":"d58976a5d50d443e334199f2b54d385a","sha256":"172b38a0d6161e1c39f2882b32a7c138e3052f050a6387b3d8d2cc955fbb0e16"},"downloads":-1,"filename":"changedetection.io-0.45-py3-none-any.whl","has_sig":false,"md5_digest":"d58976a5d50d443e334199f2b54d385a","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":638236,"upload_time":"2023-09-06T07:47:17","upload_time_iso_8601":"2023-09-06T07:47:17.192548Z","url":"https://files.pythonhosted.org/packages/76/5c/e218ad83d0d211572f9bab8540c61ed5ecdb4b2eddbf2475dd44bad7ed38/changedetection.io-0.45-py3-none-any.whl","yanked":true,"yanked_reason":"bad UI html"}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.1":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.1/","requires_dist":["apprise (~=1.4.5)","beautifulsoup4","brotli (~=1.0)","chardet (>2.3.0)","cryptography (~=3.4)","dnspython (<2.3.0)","eventlet (>=0.31.0)","feedgen (~=0.9)","flask-compress","flask-login (~=0.5)","flask-paginate","flask-expects-json (~=1.7)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","jinja2-time","jinja2 (~=3.1)","jsonpath-ng (~=1.5.3)","jsonschema (==4.17.3)","lxml","paho-mqtt","pillow","pytest-flask (~=1.2)","pytest (~=7.2)","pytz","requests[socks] (~=2.28)","selenium (~=4.1.0)","timeago (~=1.0)","urllib3 (>1.26)","validators (~=0.21)","werkzeug (~=2.0.0)","wtforms (~=3.0)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.45.1","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"608f2a8f71e3238e4b59b446c1ae0d7a0449b6edf8ccbc4fd063ec1ad92a9a2a","md5":"612f925dce99545e69d0749b5c9b26b7","sha256":"89e20906f11e0d9641d803a8bf48e96fc0ea032622bbe1c4318f246e499d357c"},"downloads":-1,"filename":"changedetection.io-0.45.1-py3-none-any.whl","has_sig":false,"md5_digest":"612f925dce99545e69d0749b5c9b26b7","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":638273,"upload_time":"2023-09-06T11:55:21","upload_time_iso_8601":"2023-09-06T11:55:21.635052Z","url":"https://files.pythonhosted.org/packages/60/8f/2a8f71e3238e4b59b446c1ae0d7a0449b6edf8ccbc4fd063ec1ad92a9a2a/changedetection.io-0.45.1-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.11":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.11/","requires_dist":["eventlet >=0.33.3","feedgen ~=0.9","flask-compress","flask-login >=0.6.3","flask-paginate","flask-expects-json ~=1.7","flask-restful","flask-wtf ~=1.2","flask ~=2.3","inscriptis ~=2.2","pytz","timeago ~=1.0","validators ~=0.21","brotli ~=1.0","requests[socks]","urllib3 >1.26","chardet >2.3.0","wtforms ~=3.0","jsonpath-ng ~=1.5.3","dnspython ~=2.4","apprise ~=1.7.1","paho-mqtt","cryptography ~=3.4","beautifulsoup4","lxml","elementpath","selenium ~=4.14.0","werkzeug ~=3.0","jinja2 ~=3.1","jinja2-time","openpyxl","pillow","pytest ~=7.2","pytest-flask ~=1.2","jsonschema ==4.17.3","jq ~=1.3 ; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq ~=1.3 ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.45.11","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"c6b55fdbf2c37837c298b5ea974ba6b86ecb2112596243db0e56ddea94f82259","md5":"7fc01009e5ab1a281828bf17f533bcf2","sha256":"6bb0bf64179fd0d352df4b7e0ae3574c32acf800f0c56ccbdaf0cd46c4a09a31"},"downloads":-1,"filename":"changedetection.io-0.45.11-py3-none-any.whl","has_sig":false,"md5_digest":"7fc01009e5ab1a281828bf17f533bcf2","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.10","size":632360,"upload_time":"2024-01-05T17:30:35","upload_time_iso_8601":"2024-01-05T17:30:35.975265Z","url":"https://files.pythonhosted.org/packages/c6/b5/5fdbf2c37837c298b5ea974ba6b86ecb2112596243db0e56ddea94f82259/changedetection.io-0.45.11-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"b32a03ba844cab0eeb543a5e2808dd59b85ccd2a55cc2fb27ede99b7f4472228","md5":"79b0e58a69a037ebabca78b4babe6507","sha256":"0029502052f56cf22289913f524da0ef1155479fa53da69a9708f149b5d49436"},"downloads":-1,"filename":"changedetection.io-0.45.11.tar.gz","has_sig":false,"md5_digest":"79b0e58a69a037ebabca78b4babe6507","packagetype":"sdist","python_version":"source","requires_python":">= 3.10","size":547765,"upload_time":"2024-01-05T17:30:37","upload_time_iso_8601":"2024-01-05T17:30:37.824057Z","url":"https://files.pythonhosted.org/packages/b3/2a/03ba844cab0eeb543a5e2808dd59b85ccd2a55cc2fb27ede99b7f4472228/changedetection.io-0.45.11.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.12":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.12/","requires_dist":["eventlet >=0.33.3","feedgen ~=0.9","flask-compress","flask-login >=0.6.3","flask-paginate","flask-expects-json ~=1.7","flask-restful","flask-wtf ~=1.2","flask ~=2.3","inscriptis ~=2.2","pytz","timeago ~=1.0","validators ~=0.21","brotli ~=1.0","requests[socks]","urllib3 >1.26","chardet >2.3.0","wtforms ~=3.0","jsonpath-ng ~=1.5.3","dnspython ~=2.4","apprise ~=1.7.1","paho-mqtt","cryptography ~=3.4","beautifulsoup4","lxml","elementpath","selenium ~=4.14.0","werkzeug ~=3.0","jinja2 ~=3.1","jinja2-time","openpyxl","pillow","pytest ~=7.2","pytest-flask ~=1.2","jsonschema ==4.17.3","jq ~=1.3 ; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq ~=1.3 ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.45.12","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"5a8dfa0348f84ec3ab359cd2c2800225429f20a986dc995e41325f8a41e7c859","md5":"0ed61b017e5ff19d34cb352e04c67d9a","sha256":"8546df2881772445d2b9f8235d3668d3377f1fe42abfe0f6b596b37e7b43b355"},"downloads":-1,"filename":"changedetection.io-0.45.12-py3-none-any.whl","has_sig":false,"md5_digest":"0ed61b017e5ff19d34cb352e04c67d9a","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.10","size":632442,"upload_time":"2024-01-05T19:18:39","upload_time_iso_8601":"2024-01-05T19:18:39.731280Z","url":"https://files.pythonhosted.org/packages/5a/8d/fa0348f84ec3ab359cd2c2800225429f20a986dc995e41325f8a41e7c859/changedetection.io-0.45.12-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"7e7212ee4df37ac79d824a9bd7ce69f89fa7c509d357ece89a36782322528def","md5":"4fca29252579af3f69dd572e6fb76395","sha256":"cf1c53ce9b1f5a3167cf6c55dfc62ceca23fcb7984c457b5eca8af6e8f61b248"},"downloads":-1,"filename":"changedetection.io-0.45.12.tar.gz","has_sig":false,"md5_digest":"4fca29252579af3f69dd572e6fb76395","packagetype":"sdist","python_version":"source","requires_python":">= 3.10","size":547830,"upload_time":"2024-01-05T19:18:42","upload_time_iso_8601":"2024-01-05T19:18:42.443507Z","url":"https://files.pythonhosted.org/packages/7e/72/12ee4df37ac79d824a9bd7ce69f89fa7c509d357ece89a36782322528def/changedetection.io-0.45.12.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.13":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.13/","requires_dist":["eventlet >=0.33.3","feedgen ~=0.9","flask-compress","flask-login >=0.6.3","flask-paginate","flask-expects-json ~=1.7","flask-restful","flask-wtf ~=1.2","flask ~=2.3","inscriptis ~=2.2","pytz","timeago ~=1.0","validators ~=0.21","brotli ~=1.0","requests[socks]","urllib3 >1.26","chardet >2.3.0","wtforms ~=3.0","jsonpath-ng ~=1.5.3","dnspython ~=2.4","apprise ~=1.7.1","paho-mqtt","cryptography ~=3.4","beautifulsoup4","lxml","elementpath","selenium ~=4.14.0","werkzeug ~=3.0","jinja2 ~=3.1","jinja2-time","openpyxl","pillow","pytest ~=7.2","pytest-flask ~=1.2","jsonschema ==4.17.3","loguru","jq ~=1.3 ; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq ~=1.3 ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.45.13","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"97642b4908949eff44e3a5b502997462ec9c536b7183179ef0fe3d55aeb356d3","md5":"25b88700b3d96c95e1f22145d8fe3505","sha256":"4bbc754342852fa7dd173014732f36bcc225a594abe4513b9fcf1a7817811414"},"downloads":-1,"filename":"changedetection.io-0.45.13-py3-none-any.whl","has_sig":false,"md5_digest":"25b88700b3d96c95e1f22145d8fe3505","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.10","size":634291,"upload_time":"2024-01-19T09:26:15","upload_time_iso_8601":"2024-01-19T09:26:15.732320Z","url":"https://files.pythonhosted.org/packages/97/64/2b4908949eff44e3a5b502997462ec9c536b7183179ef0fe3d55aeb356d3/changedetection.io-0.45.13-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"6c15e0257526057701c5090644f429c17ae8a7153d74d659e3b95c49390dc406","md5":"16b40df8e1750af046aaf1ee45a0ed69","sha256":"30e118063421222b44b9b1aa04d6ecc98550917f650df0bed3b9a949946de60b"},"downloads":-1,"filename":"changedetection.io-0.45.13.tar.gz","has_sig":false,"md5_digest":"16b40df8e1750af046aaf1ee45a0ed69","packagetype":"sdist","python_version":"source","requires_python":">= 3.10","size":549384,"upload_time":"2024-01-19T09:26:18","upload_time_iso_8601":"2024-01-19T09:26:18.103361Z","url":"https://files.pythonhosted.org/packages/6c/15/e0257526057701c5090644f429c17ae8a7153d74d659e3b95c49390dc406/changedetection.io-0.45.13.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.14":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.14/","requires_dist":["eventlet >=0.33.3","feedgen ~=0.9","flask-compress","flask-login >=0.6.3","flask-paginate","flask-expects-json ~=1.7","flask-restful","flask-wtf ~=1.2","flask ~=2.3","inscriptis ~=2.2","pytz","timeago ~=1.0","validators ~=0.21","brotli ~=1.0","requests[socks]","urllib3 >1.26","chardet >2.3.0","wtforms ~=3.0","jsonpath-ng ~=1.5.3","dnspython ~=2.4","apprise ~=1.7.1","paho-mqtt","cryptography ~=3.4","beautifulsoup4","lxml","elementpath ==4.1.5","selenium ~=4.14.0","werkzeug ~=3.0","jinja2 ~=3.1","jinja2-time","openpyxl","pillow","pytest ~=7.2","pytest-flask ~=1.2","jsonschema ==4.17.3","loguru","jq ~=1.3 ; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq ~=1.3 ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.45.14","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"7ef2ea95b31708661524bd1ecfccc6116a905cca74152e13280c00719cc15ed2","md5":"29f7689a498ada10f80a0c23a4678504","sha256":"e762b5c2d38a048e26f6fbc84cff5c5edefa063906d7220ada51e83904c804f9"},"downloads":-1,"filename":"changedetection.io-0.45.14-py3-none-any.whl","has_sig":false,"md5_digest":"29f7689a498ada10f80a0c23a4678504","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.10","size":638448,"upload_time":"2024-02-07T11:44:45","upload_time_iso_8601":"2024-02-07T11:44:45.626918Z","url":"https://files.pythonhosted.org/packages/7e/f2/ea95b31708661524bd1ecfccc6116a905cca74152e13280c00719cc15ed2/changedetection.io-0.45.14-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"9b3ffc607038da8a0a5db1e3b0e2a47524786e9a97dbdb26e3aaea12dd001f4a","md5":"fc7ae6b6a55fba294d922385892c182f","sha256":"2b222d1c7aa055eef98db5a44f7a1d375f2870893755131a886332e3e3a0a860"},"downloads":-1,"filename":"changedetection.io-0.45.14.tar.gz","has_sig":false,"md5_digest":"fc7ae6b6a55fba294d922385892c182f","packagetype":"sdist","python_version":"source","requires_python":">= 3.10","size":553498,"upload_time":"2024-02-07T11:44:47","upload_time_iso_8601":"2024-02-07T11:44:47.894759Z","url":"https://files.pythonhosted.org/packages/9b/3f/fc607038da8a0a5db1e3b0e2a47524786e9a97dbdb26e3aaea12dd001f4a/changedetection.io-0.45.14.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.15":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.15/","requires_dist":["pyee","eventlet ==0.33.3","feedgen ~=0.9","flask-compress","flask-login >=0.6.3","flask-paginate","flask-expects-json ~=1.7","flask-restful","flask-cors","flask-wtf ~=1.2","flask ~=2.3","inscriptis ~=2.2","pytz","timeago ~=1.0","validators ~=0.21","brotli ~=1.0","requests[socks]","urllib3 ==1.26.18","chardet >2.3.0","wtforms ~=3.0","jsonpath-ng ~=1.5.3","dnspython ==2.3.0","apprise ~=1.7.1","paho-mqtt","cryptography ~=3.4","beautifulsoup4","lxml","elementpath ==4.1.5","selenium ~=4.14.0","werkzeug ~=3.0","jinja2 ~=3.1","jinja2-time","openpyxl","pillow","pyppeteer-ng ==2.0.0rc2","pytest ~=7.2","pytest-flask ~=1.2","jsonschema ==4.17.3","loguru","jq ~=1.3 ; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq ~=1.3 ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.45.15","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"a4ced4b0b66af258a905ba17ba5d38894b6b85db9e37067f46e8d224d1534e9d","md5":"a57ca72c8bbf61c4993c36b19ab8a7b1","sha256":"4c4c6e37b3efda58ae3452a56339af759458bed3db930f1c79e2f446e240121a"},"downloads":-1,"filename":"changedetection.io-0.45.15-py3-none-any.whl","has_sig":false,"md5_digest":"a57ca72c8bbf61c4993c36b19ab8a7b1","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.10","size":625693,"upload_time":"2024-03-08T18:03:38","upload_time_iso_8601":"2024-03-08T18:03:38.654377Z","url":"https://files.pythonhosted.org/packages/a4/ce/d4b0b66af258a905ba17ba5d38894b6b85db9e37067f46e8d224d1534e9d/changedetection.io-0.45.15-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"580f975de1272fdef9480b85fae22c76a0bf0019158688ebdaadf5490eb470e8","md5":"5e352a4b5af93180fc80792da01ef90f","sha256":"78c3450ddd7ad4633946e7b66845f5067d4a74a0886de964005061ff07263d2c"},"downloads":-1,"filename":"changedetection.io-0.45.15.tar.gz","has_sig":false,"md5_digest":"5e352a4b5af93180fc80792da01ef90f","packagetype":"sdist","python_version":"source","requires_python":">= 3.10","size":540996,"upload_time":"2024-03-08T18:03:43","upload_time_iso_8601":"2024-03-08T18:03:43.855655Z","url":"https://files.pythonhosted.org/packages/58/0f/975de1272fdef9480b85fae22c76a0bf0019158688ebdaadf5490eb470e8/changedetection.io-0.45.15.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.16":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.16/","requires_dist":["pyee","eventlet ==0.33.3","feedgen ~=0.9","flask-compress","flask-login >=0.6.3","flask-paginate","flask-expects-json ~=1.7","flask-restful","flask-cors","flask-wtf ~=1.2","flask ~=2.3","inscriptis ~=2.2","pytz","timeago ~=1.0","validators ~=0.21","brotli ~=1.0","requests[socks]","urllib3 ==1.26.18","chardet >2.3.0","wtforms ~=3.0","jsonpath-ng ~=1.5.3","dnspython ==2.3.0","apprise ~=1.7.1","paho-mqtt","cryptography ~=3.4","beautifulsoup4","lxml","elementpath ==4.1.5","selenium ~=4.14.0","werkzeug ~=3.0","jinja2 ~=3.1","jinja2-time","openpyxl","pillow","pyppeteer-ng ==2.0.0rc2","pytest ~=7.2","pytest-flask ~=1.2","jsonschema ==4.17.3","loguru","jq ~=1.3 ; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq ~=1.3 ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.45.16","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"4ee4528a37292d1ad84315bf0d82c773ecc5aa74c91bb6f2e6696e2ac20072d8","md5":"3beac8aa3ee146abc59fd51852413e16","sha256":"dcf6756d047e54c65b61d10adf35f61b3c0f5b7fabbbee6227d3a93a5e4d00c8"},"downloads":-1,"filename":"changedetection.io-0.45.16-py3-none-any.whl","has_sig":false,"md5_digest":"3beac8aa3ee146abc59fd51852413e16","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.10","size":650779,"upload_time":"2024-03-08T20:09:12","upload_time_iso_8601":"2024-03-08T20:09:12.505151Z","url":"https://files.pythonhosted.org/packages/4e/e4/528a37292d1ad84315bf0d82c773ecc5aa74c91bb6f2e6696e2ac20072d8/changedetection.io-0.45.16-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"466d2aeba22b99db99a7c7708b11d41e94912915f4a8eba0139e56d49e59de5c","md5":"b6cabc3c78df17572fbdb3799cbdf2dd","sha256":"555e0acc9637fd58c37384ddf7d38aac42b938e8069b94146f174183171a9171"},"downloads":-1,"filename":"changedetection.io-0.45.16.tar.gz","has_sig":false,"md5_digest":"b6cabc3c78df17572fbdb3799cbdf2dd","packagetype":"sdist","python_version":"source","requires_python":">= 3.10","size":559629,"upload_time":"2024-03-08T20:09:14","upload_time_iso_8601":"2024-03-08T20:09:14.484395Z","url":"https://files.pythonhosted.org/packages/46/6d/2aeba22b99db99a7c7708b11d41e94912915f4a8eba0139e56d49e59de5c/changedetection.io-0.45.16.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.17":{"info":{"author":"dgtlmoon","author_email":null,"bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":null,"downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":null,"maintainer_email":null,"name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.17/","requires_dist":["pyee","eventlet==0.33.3","feedgen~=0.9","flask-compress","flask-login>=0.6.3","flask-paginate","flask-expects-json~=1.7","flask-restful","flask-cors","flask-wtf~=1.2","flask~=2.3","inscriptis~=2.2","pytz","timeago~=1.0","validators~=0.21","brotli~=1.0","requests[socks]","urllib3==1.26.18","chardet>2.3.0","wtforms~=3.0","jsonpath-ng~=1.5.3","dnspython==2.3.0","apprise~=1.7.4","paho-mqtt<2.0.0","cryptography~=3.4","beautifulsoup4","lxml","elementpath==4.1.5","selenium~=4.14.0","werkzeug~=3.0","jinja2~=3.1","jinja2-time","openpyxl","pillow","pyppeteer-ng==2.0.0rc5","pytest~=7.2","pytest-flask~=1.2","jsonschema==4.17.3","loguru","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">=3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.45.17","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"24237ea217903e4fd9936e393b9256bf4ef4a4a22dfb525caec69eea6d5419f2","md5":"88ac74d2f7f68bf98c39d4eba0987379","sha256":"4d41f5d67aea24aa641bce96df31630ebb518fa3e65f9735964556a9758bc41f"},"downloads":-1,"filename":"changedetection.io-0.45.17-py3-none-any.whl","has_sig":false,"md5_digest":"88ac74d2f7f68bf98c39d4eba0987379","packagetype":"bdist_wheel","python_version":"py3","requires_python":">=3.10","size":650856,"upload_time":"2024-03-31T14:37:21","upload_time_iso_8601":"2024-03-31T14:37:21.384728Z","url":"https://files.pythonhosted.org/packages/24/23/7ea217903e4fd9936e393b9256bf4ef4a4a22dfb525caec69eea6d5419f2/changedetection.io-0.45.17-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"a0bbc7c471ea1feb8409b5fee97d2fd517510e21e2cbb9993ae533053056182c","md5":"55f9d060fb9e5ed6fcce411c9dcb0273","sha256":"d1f62ff02e0313a15268ced6c96d8f54244d2233e283db85016bb09da8365fee"},"downloads":-1,"filename":"changedetection.io-0.45.17.tar.gz","has_sig":false,"md5_digest":"55f9d060fb9e5ed6fcce411c9dcb0273","packagetype":"sdist","python_version":"source","requires_python":">=3.10","size":559821,"upload_time":"2024-03-31T14:37:23","upload_time_iso_8601":"2024-03-31T14:37:23.954110Z","url":"https://files.pythonhosted.org/packages/a0/bb/c7c471ea1feb8409b5fee97d2fd517510e21e2cbb9993ae533053056182c/changedetection.io-0.45.17.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.18":{"info":{"author":"dgtlmoon","author_email":null,"bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":null,"downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":null,"maintainer_email":null,"name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.18/","requires_dist":["pyee","eventlet==0.33.3","feedgen~=0.9","flask-compress","flask-login>=0.6.3","flask-paginate","flask-expects-json~=1.7","flask-restful","flask-cors","flask-wtf~=1.2","flask~=2.3","inscriptis~=2.2","pytz","timeago~=1.0","validators~=0.21","brotli~=1.0","requests[socks]","urllib3==1.26.18","chardet>2.3.0","wtforms~=3.0","jsonpath-ng~=1.5.3","dnspython==2.3.0","apprise~=1.7.4","paho-mqtt<2.0.0","cryptography~=3.4","beautifulsoup4","lxml","elementpath==4.1.5","selenium~=4.14.0","werkzeug~=3.0","jinja2~=3.1","jinja2-time","openpyxl","pillow","pyppeteer-ng==2.0.0rc5","pytest~=7.2","pytest-flask~=1.2","jsonschema==4.17.3","loguru","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">=3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.45.18","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"b19ed249c98e522cdcc9191039743c1fd15634e4efa4d9a8aeb086a268045731","md5":"20d32ec0f00a2c10a73d043e26e0ae5c","sha256":"bbd6c3aae763ff2fbcc8a1179476bc1aa0bea9a9b3621ae0e59bcb203c562056"},"downloads":-1,"filename":"changedetection.io-0.45.18-py3-none-any.whl","has_sig":false,"md5_digest":"20d32ec0f00a2c10a73d043e26e0ae5c","packagetype":"bdist_wheel","python_version":"py3","requires_python":">=3.10","size":651891,"upload_time":"2024-04-16T16:56:41","upload_time_iso_8601":"2024-04-16T16:56:41.015248Z","url":"https://files.pythonhosted.org/packages/b1/9e/d249c98e522cdcc9191039743c1fd15634e4efa4d9a8aeb086a268045731/changedetection.io-0.45.18-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"0a394bb52e78208ad0cef4b348deef3002bd8301cb967c0226bbb1ea1815a437","md5":"1b1353a4828c4ab972e268601b18136d","sha256":"4475044347c11ab95e17434926e1f8fab14b54e8b39612a85d3ffaad709899ed"},"downloads":-1,"filename":"changedetection_io-0.45.18.tar.gz","has_sig":false,"md5_digest":"1b1353a4828c4ab972e268601b18136d","packagetype":"sdist","python_version":"source","requires_python":">=3.10","size":560628,"upload_time":"2024-04-16T16:56:43","upload_time_iso_8601":"2024-04-16T16:56:43.654249Z","url":"https://files.pythonhosted.org/packages/0a/39/4bb52e78208ad0cef4b348deef3002bd8301cb967c0226bbb1ea1815a437/changedetection_io-0.45.18.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.19":{"info":{"author":"dgtlmoon","author_email":null,"bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":null,"downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":null,"maintainer_email":null,"name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.19/","requires_dist":["pyee","eventlet==0.33.3","feedgen~=0.9","flask-compress","flask-login>=0.6.3","flask-paginate","flask-expects-json~=1.7","flask-restful","flask-cors","flask-wtf~=1.2","flask~=2.3","inscriptis~=2.2","pytz","timeago~=1.0","validators~=0.21","brotli~=1.0","requests[socks]","urllib3==1.26.18","chardet>2.3.0","wtforms~=3.0","jsonpath-ng~=1.5.3","dnspython==2.3.0","apprise~=1.7.4","paho-mqtt<2.0.0","cryptography~=3.4","beautifulsoup4","lxml","elementpath==4.1.5","selenium~=4.14.0","werkzeug~=3.0","jinja2~=3.1","jinja2-time","openpyxl","pillow","pyppeteer-ng==2.0.0rc5","pytest~=7.2","pytest-flask~=1.2","jsonschema==4.17.3","loguru","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">=3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.45.19","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"df1f2ec14c23682bff56680f79106ef87fd10a98d98ed8736c51fe98e6229231","md5":"cb17e99f0fc2969737f10be4be39e9e3","sha256":"6ffc67abb042a264236a491ed327adecbdc3c2ab7d851a4fc7768e1952ce025b"},"downloads":-1,"filename":"changedetection.io-0.45.19-py3-none-any.whl","has_sig":false,"md5_digest":"cb17e99f0fc2969737f10be4be39e9e3","packagetype":"bdist_wheel","python_version":"py3","requires_python":">=3.10","size":652140,"upload_time":"2024-04-17T18:03:23","upload_time_iso_8601":"2024-04-17T18:03:23.040639Z","url":"https://files.pythonhosted.org/packages/df/1f/2ec14c23682bff56680f79106ef87fd10a98d98ed8736c51fe98e6229231/changedetection.io-0.45.19-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"156ddb9351cbc74b3a6b7d9cde2c2920e3d955d6d4f10c72c0a8fa49ed86e73c","md5":"e8273e068ffb0b47666385f56c7036b8","sha256":"df24a8da5e6112d271663a0c07535d722d669b52b2a218c0d0171cc94e167f1e"},"downloads":-1,"filename":"changedetection_io-0.45.19.tar.gz","has_sig":false,"md5_digest":"e8273e068ffb0b47666385f56c7036b8","packagetype":"sdist","python_version":"source","requires_python":">=3.10","size":560930,"upload_time":"2024-04-17T18:03:33","upload_time_iso_8601":"2024-04-17T18:03:33.068301Z","url":"https://files.pythonhosted.org/packages/15/6d/db9351cbc74b3a6b7d9cde2c2920e3d955d6d4f10c72c0a8fa49ed86e73c/changedetection_io-0.45.19.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.2":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.2/","requires_dist":["eventlet (>=0.31.0)","feedgen (~=0.9)","flask-compress","flask-login (~=0.5)","flask-paginate","flask-expects-json (~=1.7)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","pytz","timeago (~=1.0)","validators (~=0.21)","brotli (~=1.0)","requests[socks] (~=2.28)","urllib3 (>1.26)","chardet (>2.3.0)","wtforms (~=3.0)","jsonpath-ng (~=1.5.3)","dnspython (<2.3.0)","apprise (~=1.5.0)","paho-mqtt","cryptography (~=3.4)","beautifulsoup4","lxml","selenium (~=4.1.0)","werkzeug (~=2.0.0)","jinja2 (~=3.1)","jinja2-time","pillow","pytest (~=7.2)","pytest-flask (~=1.2)","jsonschema (==4.17.3)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.6","summary":"Website change detection and monitoring service","version":"0.45.2","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"1888ed59c61b3b8887bc6a29dbb94c55de638878549d4153064299907774906a","md5":"01a450b50c301be2acd46a5444c3791b","sha256":"7e2bda482857dfe17440634f141d07600a9228728eaf3a6fe6634ef56029fc72"},"downloads":-1,"filename":"changedetection.io-0.45.2-py3-none-any.whl","has_sig":false,"md5_digest":"01a450b50c301be2acd46a5444c3791b","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.6","size":640060,"upload_time":"2023-09-22T07:51:31","upload_time_iso_8601":"2023-09-22T07:51:31.533842Z","url":"https://files.pythonhosted.org/packages/18/88/ed59c61b3b8887bc6a29dbb94c55de638878549d4153064299907774906a/changedetection.io-0.45.2-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.20":{"info":{"author":"dgtlmoon","author_email":null,"bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":null,"downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":null,"maintainer_email":null,"name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.20/","requires_dist":["pyee","eventlet==0.33.3","feedgen~=0.9","flask-compress","flask-login>=0.6.3","flask-paginate","flask-expects-json~=1.7","flask-restful","flask-cors","flask-wtf~=1.2","flask~=2.3","inscriptis~=2.2","pytz","timeago~=1.0","validators~=0.21","brotli~=1.0","requests[socks]","urllib3==1.26.18","chardet>2.3.0","wtforms~=3.0","jsonpath-ng~=1.5.3","dnspython==2.3.0","apprise~=1.7.4","paho-mqtt<2.0.0","cryptography~=3.4","beautifulsoup4","lxml<6,>=4.8.0","elementpath==4.1.5","selenium~=4.14.0","werkzeug~=3.0","jinja2~=3.1","jinja2-time","openpyxl","pillow","pyppeteer-ng==2.0.0rc5","pytest~=7.2","pytest-flask~=1.2","jsonschema==4.17.3","loguru","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">=3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.45.20","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"f2d51a9dd357c4ae4a722169af311f0dc02a7f49fe549837c5ffe04d6ced4d7b","md5":"43a23e5b0927617758957d71cf9d91b2","sha256":"73b177010c452afeeb7bffde0c544f26f539b47387f89a651a7b16cb1a631b7a"},"downloads":-1,"filename":"changedetection.io-0.45.20-py3-none-any.whl","has_sig":false,"md5_digest":"43a23e5b0927617758957d71cf9d91b2","packagetype":"bdist_wheel","python_version":"py3","requires_python":">=3.10","size":652189,"upload_time":"2024-04-18T09:57:26","upload_time_iso_8601":"2024-04-18T09:57:26.869794Z","url":"https://files.pythonhosted.org/packages/f2/d5/1a9dd357c4ae4a722169af311f0dc02a7f49fe549837c5ffe04d6ced4d7b/changedetection.io-0.45.20-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"0629add563cddad6a997695d5b422f569950710ad262a5c1f8c2b35b125f3603","md5":"3def3cd93f5c298044ce7ca6ace59624","sha256":"f80b8a6d492846d06a4aff30f07a670ce0d41d785c7ebce47144d72d5742b9f2"},"downloads":-1,"filename":"changedetection_io-0.45.20.tar.gz","has_sig":false,"md5_digest":"3def3cd93f5c298044ce7ca6ace59624","packagetype":"sdist","python_version":"source","requires_python":">=3.10","size":560926,"upload_time":"2024-04-18T09:57:31","upload_time_iso_8601":"2024-04-18T09:57:31.047857Z","url":"https://files.pythonhosted.org/packages/06/29/add563cddad6a997695d5b422f569950710ad262a5c1f8c2b35b125f3603/changedetection_io-0.45.20.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.21":{"info":{"author":"dgtlmoon","author_email":null,"bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":null,"downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":null,"maintainer_email":null,"name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.21/","requires_dist":["pyee","eventlet==0.33.3","feedgen~=0.9","flask-compress","flask-login>=0.6.3","flask-paginate","flask-expects-json~=1.7","flask-restful","flask-cors","flask-wtf~=1.2","flask~=2.3","inscriptis~=2.2","pytz","timeago~=1.0","validators~=0.21","brotli~=1.0","requests[socks]","urllib3==1.26.18","chardet>2.3.0","wtforms~=3.0","jsonpath-ng~=1.5.3","dnspython==2.3.0","apprise~=1.7.4","paho-mqtt<2.0.0","cryptography~=3.4","beautifulsoup4","lxml<6,>=4.8.0","elementpath==4.1.5","selenium~=4.14.0","werkzeug~=3.0","jinja2~=3.1","jinja2-time","openpyxl","pillow","pyppeteer-ng==2.0.0rc5","pytest~=7.2","pytest-flask~=1.2","jsonschema==4.17.3","loguru","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">=3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.45.21","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"78a8735101f019729afbdf9f905c6d044d6b0578cb204f42b8fe68ea3cf57f82","md5":"05969144a42ae602d9c2ecd80a2309d0","sha256":"ccf8e90c5dd7f7b1fd2055d588a2a84b1a22edd10eb5868db3c26ceae475cd4f"},"downloads":-1,"filename":"changedetection.io-0.45.21-py3-none-any.whl","has_sig":false,"md5_digest":"05969144a42ae602d9c2ecd80a2309d0","packagetype":"bdist_wheel","python_version":"py3","requires_python":">=3.10","size":654015,"upload_time":"2024-04-25T20:32:19","upload_time_iso_8601":"2024-04-25T20:32:19.683525Z","url":"https://files.pythonhosted.org/packages/78/a8/735101f019729afbdf9f905c6d044d6b0578cb204f42b8fe68ea3cf57f82/changedetection.io-0.45.21-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"1a4647ff9f2a931ace0204963fddb9b13e1dd6de88e2f2f0f2dffb1cec8d046e","md5":"579e7eb964565ea6f2e56fcefeaae495","sha256":"262f5eb998474ed7465923d53dd7a515bc11a8164ee0549b9d84beee5a2b350d"},"downloads":-1,"filename":"changedetection_io-0.45.21.tar.gz","has_sig":false,"md5_digest":"579e7eb964565ea6f2e56fcefeaae495","packagetype":"sdist","python_version":"source","requires_python":">=3.10","size":562017,"upload_time":"2024-04-25T20:32:24","upload_time_iso_8601":"2024-04-25T20:32:24.631006Z","url":"https://files.pythonhosted.org/packages/1a/46/47ff9f2a931ace0204963fddb9b13e1dd6de88e2f2f0f2dffb1cec8d046e/changedetection_io-0.45.21.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.22":{"info":{"author":"dgtlmoon","author_email":null,"bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":null,"downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":null,"maintainer_email":null,"name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.22/","requires_dist":["pyee","eventlet==0.33.3","feedgen~=0.9","flask-compress","flask-login>=0.6.3","flask-paginate","flask-expects-json~=1.7","flask-restful","flask-cors","flask-wtf~=1.2","flask~=2.3","inscriptis~=2.2","pytz","timeago~=1.0","validators~=0.21","brotli~=1.0","requests[socks]","urllib3==1.26.18","chardet>2.3.0","wtforms~=3.0","jsonpath-ng~=1.5.3","dnspython==2.3.0","apprise~=1.7.4","paho-mqtt<2.0.0","cryptography~=3.4","beautifulsoup4","lxml<6,>=4.8.0","elementpath==4.1.5","selenium~=4.14.0","werkzeug~=3.0","jinja2~=3.1","jinja2-time","openpyxl","pillow","pyppeteer-ng==2.0.0rc5","pytest~=7.2","pytest-flask~=1.2","jsonschema==4.17.3","loguru","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">=3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.45.22","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"e5081fea08fa24a4596194cc6526ff21726bd8118442f8cec1f6af6b34f87d69","md5":"51e167d6167fc5459856e2e38fe947b1","sha256":"4c6a0b459f7ad111cf580de98964fac5a31f639ab1a629fd80c2a45e75e85b48"},"downloads":-1,"filename":"changedetection.io-0.45.22-py3-none-any.whl","has_sig":false,"md5_digest":"51e167d6167fc5459856e2e38fe947b1","packagetype":"bdist_wheel","python_version":"py3","requires_python":">=3.10","size":654597,"upload_time":"2024-05-02T10:11:33","upload_time_iso_8601":"2024-05-02T10:11:33.862463Z","url":"https://files.pythonhosted.org/packages/e5/08/1fea08fa24a4596194cc6526ff21726bd8118442f8cec1f6af6b34f87d69/changedetection.io-0.45.22-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"1580d923309eaeaa0a101d69c7bf07d77177b792ef8d68fac23631e20d651a37","md5":"f5c73fdacc9182d4cf84e021a66a45af","sha256":"af0d64053dabcce869d20d9d094aa46a7e533a25ba8a3286607e5007a24ab535"},"downloads":-1,"filename":"changedetection_io-0.45.22.tar.gz","has_sig":false,"md5_digest":"f5c73fdacc9182d4cf84e021a66a45af","packagetype":"sdist","python_version":"source","requires_python":">=3.10","size":562335,"upload_time":"2024-05-02T10:11:36","upload_time_iso_8601":"2024-05-02T10:11:36.206889Z","url":"https://files.pythonhosted.org/packages/15/80/d923309eaeaa0a101d69c7bf07d77177b792ef8d68fac23631e20d651a37/changedetection_io-0.45.22.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.23":{"info":{"author":"dgtlmoon","author_email":null,"bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":null,"downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":null,"maintainer_email":null,"name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.23/","requires_dist":["pyee","eventlet==0.33.3","feedgen~=0.9","flask-compress","flask-login>=0.6.3","flask-paginate","flask-expects-json~=1.7","flask-restful","flask-cors","flask-wtf~=1.2","flask~=2.3","inscriptis~=2.2","pytz","timeago~=1.0","validators~=0.21","brotli~=1.0","requests[socks]","urllib3==1.26.18","chardet>2.3.0","wtforms~=3.0","jsonpath-ng~=1.5.3","dnspython==2.3.0","apprise~=1.8.0","paho-mqtt<2.0.0,>=1.6.1","cryptography~=3.4","beautifulsoup4","lxml!=5.2.0,!=5.2.1,<6,>=4.8.0","elementpath==4.1.5","selenium~=4.14.0","werkzeug~=3.0","jinja2~=3.1","jinja2-time","openpyxl","pillow","pyppeteer-ng==2.0.0rc5","pyppeteerstealth>=0.0.4","pytest~=7.2","pytest-flask~=1.2","jsonschema==4.17.3","loguru","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">=3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.45.23","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"92364ac1c203dbb15e0c5a3e67c074132300673391d07b74658d54aed675ee3c","md5":"87d600eda0eb9b76b1aee393431b0bae","sha256":"e0d3d7a6c6cf8a1e31635dee21e7b798cbabbf9e7aa92976f26131ba5a64701d"},"downloads":-1,"filename":"changedetection.io-0.45.23-py3-none-any.whl","has_sig":false,"md5_digest":"87d600eda0eb9b76b1aee393431b0bae","packagetype":"bdist_wheel","python_version":"py3","requires_python":">=3.10","size":639781,"upload_time":"2024-05-21T22:03:29","upload_time_iso_8601":"2024-05-21T22:03:29.424631Z","url":"https://files.pythonhosted.org/packages/92/36/4ac1c203dbb15e0c5a3e67c074132300673391d07b74658d54aed675ee3c/changedetection.io-0.45.23-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"dca5d6470eafb71975afbebf93b53b29d53ca1cc068943de5991754e0a748680","md5":"f20f226d8247b868366a8fc460fd74d8","sha256":"e4f744569c500a9e7d25f7e8da2bbf9ad8c077364fc634e6d96b1f9a434e48a3"},"downloads":-1,"filename":"changedetection_io-0.45.23.tar.gz","has_sig":false,"md5_digest":"f20f226d8247b868366a8fc460fd74d8","packagetype":"sdist","python_version":"source","requires_python":">=3.10","size":546721,"upload_time":"2024-05-21T22:03:32","upload_time_iso_8601":"2024-05-21T22:03:32.008594Z","url":"https://files.pythonhosted.org/packages/dc/a5/d6470eafb71975afbebf93b53b29d53ca1cc068943de5991754e0a748680/changedetection_io-0.45.23.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.24":{"info":{"author":"dgtlmoon","author_email":null,"bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":null,"downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":null,"maintainer_email":null,"name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.24/","requires_dist":["pyee","eventlet>=0.36.1","feedgen~=0.9","flask-compress","flask-login>=0.6.3","flask-paginate","flask-expects-json~=1.7","flask-restful","flask-cors","flask-wtf~=1.2","flask~=2.3","inscriptis~=2.2","pytz","timeago~=1.0","validators~=0.21","brotli~=1.0","requests[socks]","urllib3==1.26.18","chardet>2.3.0","wtforms~=3.0","jsonpath-ng~=1.5.3","dnspython==2.6.1","apprise~=1.8.0","paho-mqtt<2.0.0,>=1.6.1","cryptography~=3.4","beautifulsoup4","lxml!=5.2.0,!=5.2.1,<6,>=4.8.0","elementpath==4.1.5","selenium~=4.14.0","werkzeug~=3.0","jinja2~=3.1","jinja2-time","openpyxl","pyppeteer-ng==2.0.0rc5","pyppeteerstealth>=0.0.4","pytest~=7.2","pytest-flask~=1.2","jsonschema==4.17.3","loguru","greenlet>=3.0.3","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">=3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.45.24","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"2b7369dd32ccbff6913c4ba1a1674f31bd7702d95e15bbd70d28fce5d380fe13","md5":"d8eb0e4f3182f188aa9d75204f93595a","sha256":"8951c453598805c0dfd10789580a906688ce128f1414173e8ede067d331adac6"},"downloads":-1,"filename":"changedetection.io-0.45.24-py3-none-any.whl","has_sig":false,"md5_digest":"d8eb0e4f3182f188aa9d75204f93595a","packagetype":"bdist_wheel","python_version":"py3","requires_python":">=3.10","size":640599,"upload_time":"2024-06-17T11:28:55","upload_time_iso_8601":"2024-06-17T11:28:55.732784Z","url":"https://files.pythonhosted.org/packages/2b/73/69dd32ccbff6913c4ba1a1674f31bd7702d95e15bbd70d28fce5d380fe13/changedetection.io-0.45.24-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"c98ec80687eb5627e35dfe0e5e3875cb2b5086fa4a6691726a57640085a14cda","md5":"467231eef69d9b5ad6d96627c1cfc674","sha256":"d9835165910173d78a235e4d606ad6ff07a40deaf2a548197c155e1bcafee6a2"},"downloads":-1,"filename":"changedetection_io-0.45.24.tar.gz","has_sig":false,"md5_digest":"467231eef69d9b5ad6d96627c1cfc674","packagetype":"sdist","python_version":"source","requires_python":">=3.10","size":547459,"upload_time":"2024-06-17T11:28:58","upload_time_iso_8601":"2024-06-17T11:28:58.598759Z","url":"https://files.pythonhosted.org/packages/c9/8e/c80687eb5627e35dfe0e5e3875cb2b5086fa4a6691726a57640085a14cda/changedetection_io-0.45.24.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.25":{"info":{"author":"dgtlmoon","author_email":null,"bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":null,"downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":null,"maintainer_email":null,"name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.25/","requires_dist":["pyee","eventlet>=0.36.1","feedgen~=0.9","flask-compress","flask-login>=0.6.3","flask-paginate","flask-expects-json~=1.7","flask-restful","flask-cors","flask-wtf~=1.2","flask~=2.3","inscriptis~=2.2","pytz","timeago~=1.0","validators~=0.21","brotli~=1.0","requests[socks]","urllib3==1.26.19","chardet>2.3.0","wtforms~=3.0","jsonpath-ng~=1.5.3","dnspython==2.6.1","apprise~=1.8.0","paho-mqtt<2.0.0,>=1.6.1","cryptography~=42.0.8","beautifulsoup4","lxml!=5.2.0,!=5.2.1,<6,>=4.8.0","elementpath==4.1.5","selenium~=4.14.0","werkzeug~=3.0","jinja2~=3.1","jinja2-time","openpyxl","pyppeteer-ng==2.0.0rc5","pyppeteerstealth>=0.0.4","pytest~=7.2","pytest-flask~=1.2","jsonschema==4.17.3","loguru","greenlet>=3.0.3","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">=3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.45.25","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"5d3ed8323baa04086218df75cb64cfb4507b063405149b0baffecb8f3e5c1e11","md5":"7bdebdb566b833c23f7b867fafcda10b","sha256":"bef7147bd25b197ca3182abf3178e82e0bdf7242640ec3ef93e7537b1ed51608"},"downloads":-1,"filename":"changedetection.io-0.45.25-py3-none-any.whl","has_sig":false,"md5_digest":"7bdebdb566b833c23f7b867fafcda10b","packagetype":"bdist_wheel","python_version":"py3","requires_python":">=3.10","size":641181,"upload_time":"2024-07-03T17:28:53","upload_time_iso_8601":"2024-07-03T17:28:53.770092Z","url":"https://files.pythonhosted.org/packages/5d/3e/d8323baa04086218df75cb64cfb4507b063405149b0baffecb8f3e5c1e11/changedetection.io-0.45.25-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"37400e5c3b8a4802f24748eebcb03e186be85bb0bd108c60c420b0e1450c79b7","md5":"6a816fed14a9b6d2ee59acdb6e15717c","sha256":"788f30d00203121ccce254b4c3d77b4359bcaa305f9f4e25f830007e80cf1a6a"},"downloads":-1,"filename":"changedetection_io-0.45.25.tar.gz","has_sig":false,"md5_digest":"6a816fed14a9b6d2ee59acdb6e15717c","packagetype":"sdist","python_version":"source","requires_python":">=3.10","size":547828,"upload_time":"2024-07-03T17:28:56","upload_time_iso_8601":"2024-07-03T17:28:56.298441Z","url":"https://files.pythonhosted.org/packages/37/40/0e5c3b8a4802f24748eebcb03e186be85bb0bd108c60c420b0e1450c79b7/changedetection_io-0.45.25.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.26":{"info":{"author":"dgtlmoon","author_email":null,"bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":null,"downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":null,"maintainer_email":null,"name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.26/","requires_dist":["pyee","eventlet>=0.36.1","feedgen~=0.9","flask-compress","flask-login>=0.6.3","flask-paginate","flask-expects-json~=1.7","flask-restful","flask-cors","flask-wtf~=1.2","flask~=2.3","inscriptis~=2.2","pytz","timeago~=1.0","validators~=0.21","brotli~=1.0","requests[socks]","urllib3==1.26.19","chardet>2.3.0","wtforms~=3.0","jsonpath-ng~=1.5.3","dnspython==2.6.1","apprise~=1.8.0","paho-mqtt<2.0.0,>=1.6.1","cryptography~=42.0.8","beautifulsoup4","lxml!=5.2.0,!=5.2.1,<6,>=4.8.0","elementpath==4.1.5","selenium~=4.14.0","werkzeug~=3.0","jinja2~=3.1","jinja2-time","openpyxl","pyppeteer-ng==2.0.0rc5","pyppeteerstealth>=0.0.4","pytest~=7.2","pytest-flask~=1.2","jsonschema==4.17.3","loguru","greenlet>=3.0.3","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">=3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.45.26","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"68fa4b3dfe662693f0911239a5ced890607af7c52f3a5158e0d36bd51dea4536","md5":"7c562b8741bd70558bedadaa04c992ea","sha256":"e587a643c588992b3ace4dde789085eac6916cbc4d5d8e5bebe6c7f4946037ca"},"downloads":-1,"filename":"changedetection.io-0.45.26-py3-none-any.whl","has_sig":false,"md5_digest":"7c562b8741bd70558bedadaa04c992ea","packagetype":"bdist_wheel","python_version":"py3","requires_python":">=3.10","size":641912,"upload_time":"2024-07-11T11:53:41","upload_time_iso_8601":"2024-07-11T11:53:41.278639Z","url":"https://files.pythonhosted.org/packages/68/fa/4b3dfe662693f0911239a5ced890607af7c52f3a5158e0d36bd51dea4536/changedetection.io-0.45.26-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"7580e7b135d87eec74725dd1fbbacc0fc9806b4b2c5d4df8c4e648ae8a0ffd5f","md5":"9e3f523240b40c3266b63347b4301c5f","sha256":"8cb5b2fc326feec30f6e3a33d00125e22f842d318e97897a6e8a58bfdfd35ece"},"downloads":-1,"filename":"changedetection_io-0.45.26.tar.gz","has_sig":false,"md5_digest":"9e3f523240b40c3266b63347b4301c5f","packagetype":"sdist","python_version":"source","requires_python":">=3.10","size":548535,"upload_time":"2024-07-11T11:53:43","upload_time_iso_8601":"2024-07-11T11:53:43.611273Z","url":"https://files.pythonhosted.org/packages/75/80/e7b135d87eec74725dd1fbbacc0fc9806b4b2c5d4df8c4e648ae8a0ffd5f/changedetection_io-0.45.26.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.3":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.3/","requires_dist":["eventlet (>=0.31.0)","feedgen (~=0.9)","flask-compress","flask-login (~=0.5)","flask-paginate","flask-expects-json (~=1.7)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","pytz","timeago (~=1.0)","validators (~=0.21)","brotli (~=1.0)","requests[socks] (~=2.28)","urllib3 (>1.26)","chardet (>2.3.0)","wtforms (~=3.0)","jsonpath-ng (~=1.5.3)","dnspython (<2.3.0)","apprise (~=1.5.0)","paho-mqtt","cryptography (~=3.4)","beautifulsoup4","lxml","selenium (~=4.1.0)","werkzeug (~=2.0.0)","jinja2 (~=3.1)","jinja2-time","pillow","pytest (~=7.2)","pytest-flask (~=1.2)","jsonschema (==4.17.3)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.7","summary":"Website change detection and monitoring service","version":"0.45.3","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"0c993f8d607c55c048573f4a5d11656a0119a4137e8d4b43657753710a76bfc8","md5":"aa1bdc9140949a7db839c81f97e96219","sha256":"98c137ee699b0066132d63006fa301672edb9f728f901e57cadd201d286ad5b6"},"downloads":-1,"filename":"changedetection.io-0.45.3-py3-none-any.whl","has_sig":false,"md5_digest":"aa1bdc9140949a7db839c81f97e96219","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.7","size":642856,"upload_time":"2023-10-05T11:17:53","upload_time_iso_8601":"2023-10-05T11:17:53.651543Z","url":"https://files.pythonhosted.org/packages/0c/99/3f8d607c55c048573f4a5d11656a0119a4137e8d4b43657753710a76bfc8/changedetection.io-0.45.3-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.4":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.4/","requires_dist":["eventlet (>=0.31.0)","feedgen (~=0.9)","flask-compress","flask-login (~=0.5)","flask-paginate","flask-expects-json (~=1.7)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","pytz","timeago (~=1.0)","validators (~=0.21)","brotli (~=1.0)","requests[socks]","urllib3 (>1.26)","chardet (>2.3.0)","wtforms (~=3.0)","jsonpath-ng (~=1.5.3)","dnspython (<2.3.0)","apprise (~=1.6.0)","paho-mqtt","cryptography (~=3.4)","beautifulsoup4","lxml","selenium (~=4.14.0)","werkzeug (~=2.0.0)","jinja2 (~=3.1)","jinja2-time","pillow","pytest (~=7.2)","pytest-flask (~=1.2)","jsonschema (==4.17.3)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.7","summary":"Website change detection and monitoring service","version":"0.45.4","yanked":true,"yanked_reason":"BrowserSteps didnt work as expected #1910"},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"61bb67d04b351d24e8d366adf62f8f255a40a0ff46ffcf26fbb26799c86b70b0","md5":"adb4bc644c01c59ec16c01ed319602c6","sha256":"45c5bad6e7e2e372dc1c2982820a833b8b4a222c5278cf3ed269efe0fe75ea15"},"downloads":-1,"filename":"changedetection.io-0.45.4-py3-none-any.whl","has_sig":false,"md5_digest":"adb4bc644c01c59ec16c01ed319602c6","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.7","size":673232,"upload_time":"2023-10-28T14:50:22","upload_time_iso_8601":"2023-10-28T14:50:22.910975Z","url":"https://files.pythonhosted.org/packages/61/bb/67d04b351d24e8d366adf62f8f255a40a0ff46ffcf26fbb26799c86b70b0/changedetection.io-0.45.4-py3-none-any.whl","yanked":true,"yanked_reason":"BrowserSteps didnt work as expected #1910"}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.5":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.5/","requires_dist":["eventlet (>=0.31.0)","feedgen (~=0.9)","flask-compress","flask-login (~=0.5)","flask-paginate","flask-expects-json (~=1.7)","flask-restful","flask-wtf","flask (~=2.0)","inscriptis (~=2.2)","pytz","timeago (~=1.0)","validators (~=0.21)","brotli (~=1.0)","requests[socks]","urllib3 (>1.26)","chardet (>2.3.0)","wtforms (~=3.0)","jsonpath-ng (~=1.5.3)","dnspython (<2.3.0)","apprise (~=1.6.0)","paho-mqtt","cryptography (~=3.4)","beautifulsoup4","lxml","selenium (~=4.14.0)","werkzeug (~=2.0.0)","jinja2 (~=3.1)","jinja2-time","pillow","pytest (~=7.2)","pytest-flask (~=1.2)","jsonschema (==4.17.3)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.7","summary":"Website change detection and monitoring service","version":"0.45.5","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"af05e33a06d6538f901266aa9ea641b81867109f802fbe3d143a54a711a17cd2","md5":"80ae3852b4846250ea70a8196227cef8","sha256":"23e3a762c8bf0ced1fefb64b2164dce94d1706356c972c6aa8e8d01af1b02ed7"},"downloads":-1,"filename":"changedetection.io-0.45.5-py3-none-any.whl","has_sig":false,"md5_digest":"80ae3852b4846250ea70a8196227cef8","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.7","size":673305,"upload_time":"2023-10-28T18:22:14","upload_time_iso_8601":"2023-10-28T18:22:14.070556Z","url":"https://files.pythonhosted.org/packages/af/05/e33a06d6538f901266aa9ea641b81867109f802fbe3d143a54a711a17cd2/changedetection.io-0.45.5-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.6":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.6/","requires_dist":["eventlet (>=0.31.0)","feedgen (~=0.9)","flask-compress","flask-login (~=0.6)","flask-paginate","flask-expects-json (~=1.7)","flask-restful","flask-wtf","flask (~=2.3)","inscriptis (~=2.2)","pytz","timeago (~=1.0)","validators (~=0.21)","brotli (~=1.0)","requests[socks]","urllib3 (>1.26)","chardet (>2.3.0)","wtforms (~=3.0)","jsonpath-ng (~=1.5.3)","dnspython (<2.3.0)","apprise (~=1.6.0)","paho-mqtt","cryptography (~=3.4)","beautifulsoup4","lxml","selenium (~=4.14.0)","werkzeug","jinja2 (~=3.1)","jinja2-time","openpyxl","pillow","pytest (~=7.2)","pytest-flask (~=1.2)","jsonschema (==4.17.3)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.7","summary":"Website change detection and monitoring service","version":"0.45.6","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"ba797b9f0dce1cd0b292e93126676ae62d10f47f6ad3743c2953b39bb1e3ee34","md5":"2c774b20cb07a49064f3182bdebcab4c","sha256":"0e58e3d76da78230408607583b44b016c979a029b59875cc33163077c09ca6d9"},"downloads":-1,"filename":"changedetection.io-0.45.6-py3-none-any.whl","has_sig":false,"md5_digest":"2c774b20cb07a49064f3182bdebcab4c","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.7","size":689521,"upload_time":"2023-11-10T16:34:11","upload_time_iso_8601":"2023-11-10T16:34:11.125415Z","url":"https://files.pythonhosted.org/packages/ba/79/7b9f0dce1cd0b292e93126676ae62d10f47f6ad3743c2953b39bb1e3ee34/changedetection.io-0.45.6-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.7":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.7/","requires_dist":["eventlet (>=0.31.0)","feedgen (~=0.9)","flask-compress","flask-login (~=0.6)","flask-paginate","flask-expects-json (~=1.7)","flask-restful","flask-wtf","flask (~=2.3)","inscriptis (~=2.2)","pytz","timeago (~=1.0)","validators (~=0.21)","brotli (~=1.0)","requests[socks]","urllib3 (>1.26)","chardet (>2.3.0)","wtforms (~=3.0)","jsonpath-ng (~=1.5.3)","dnspython (<2.3.0)","apprise (~=1.6.0)","paho-mqtt","cryptography (~=3.4)","beautifulsoup4","lxml","selenium (~=4.14.0)","werkzeug","jinja2 (~=3.1)","jinja2-time","openpyxl","pillow","pytest (~=7.2)","pytest-flask (~=1.2)","jsonschema (==4.17.3)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.7","summary":"Website change detection and monitoring service","version":"0.45.7","yanked":true,"yanked_reason":"Needed better pinning for older packages"},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"967b076b4ceb9739fcaa3c58e218f81d6f0d48e823a293f0620065308974b401","md5":"3385d99add916e8137e40ae7f61b2bea","sha256":"30bf2781ff963aead2f9f9301fd22376175036d9b440bcf878746629de650416"},"downloads":-1,"filename":"changedetection.io-0.45.7-py3-none-any.whl","has_sig":false,"md5_digest":"3385d99add916e8137e40ae7f61b2bea","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.7","size":689535,"upload_time":"2023-11-10T16:42:15","upload_time_iso_8601":"2023-11-10T16:42:15.796417Z","url":"https://files.pythonhosted.org/packages/96/7b/076b4ceb9739fcaa3c58e218f81d6f0d48e823a293f0620065308974b401/changedetection.io-0.45.7-py3-none-any.whl","yanked":true,"yanked_reason":"Needed better pinning for older packages"}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.7.1":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.7.1/","requires_dist":["requests[socks]","eventlet (>=0.33.3)","feedgen (~=0.9)","flask-compress","flask-login (>=0.6.3)","flask-paginate","flask-expects-json (~=1.7)","flask-restful","flask-wtf (~=1.2)","flask (~=2.3)","inscriptis (~=2.2)","pytz","timeago (~=1.0)","validators (~=0.21)","brotli (~=1.0)","urllib3 (>1.26)","chardet (>2.3.0)","wtforms (~=3.0)","jsonpath-ng (~=1.5.3)","dnspython (~=2.4)","apprise (~=1.6.0)","paho-mqtt","cryptography (~=3.4)","beautifulsoup4","lxml","selenium (~=4.14.0)","werkzeug (~=3.0)","jinja2 (~=3.1)","jinja2-time","openpyxl","pillow","pytest (~=7.2)","pytest-flask (~=1.2)","jsonschema (==4.17.3)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.7","summary":"Website change detection and monitoring service","version":"0.45.7.1","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"99caf4e1853ec1d6dc9dc7e1fb0e4713aa55fec337e66c36fe0cd3c3debb2ba6","md5":"9be93fac5d61ff8e409f5dc66b52d52c","sha256":"3262483a27e8e355a6baf900de8a29da609d6cb18d7975c0b15e6e7f2dc777ad"},"downloads":-1,"filename":"changedetection.io-0.45.7.1-py3-none-any.whl","has_sig":false,"md5_digest":"9be93fac5d61ff8e409f5dc66b52d52c","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.7","size":667040,"upload_time":"2023-11-11T19:43:27","upload_time_iso_8601":"2023-11-11T19:43:27.618585Z","url":"https://files.pythonhosted.org/packages/99/ca/f4e1853ec1d6dc9dc7e1fb0e4713aa55fec337e66c36fe0cd3c3debb2ba6/changedetection.io-0.45.7.1-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.7.2":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.7.2/","requires_dist":["eventlet (>=0.33.3)","feedgen (~=0.9)","flask-compress","flask-login (>=0.6.3)","flask-paginate","flask-expects-json (~=1.7)","flask-restful","flask-wtf (~=1.2)","flask (~=2.3)","inscriptis (~=2.2)","pytz","timeago (~=1.0)","validators (~=0.21)","brotli (~=1.0)","requests[socks]","urllib3 (>1.26)","chardet (>2.3.0)","wtforms (~=3.0)","jsonpath-ng (~=1.5.3)","dnspython (~=2.4)","apprise (~=1.6.0)","paho-mqtt","cryptography (~=3.4)","beautifulsoup4","lxml","selenium (~=4.14.0)","werkzeug (~=3.0)","jinja2 (~=3.1)","jinja2-time","openpyxl","pillow","pytest (~=7.2)","pytest-flask (~=1.2)","jsonschema (==4.17.3)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.7","summary":"Website change detection and monitoring service","version":"0.45.7.2","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"aa7878a7ea9fef0a2be4b980e97020ef30c6099cd94ea73e59c1b6a6cf510de8","md5":"b14317ab4ce1bc4f8291368befd57f44","sha256":"11102a81e5e3631beccb3dcce9d4b2dcfd3c98301abba5cf793fcabdfe7b5319"},"downloads":-1,"filename":"changedetection.io-0.45.7.2-py3-none-any.whl","has_sig":false,"md5_digest":"b14317ab4ce1bc4f8291368befd57f44","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.7","size":667199,"upload_time":"2023-11-11T23:35:19","upload_time_iso_8601":"2023-11-11T23:35:19.182644Z","url":"https://files.pythonhosted.org/packages/aa/78/78a7ea9fef0a2be4b980e97020ef30c6099cd94ea73e59c1b6a6cf510de8/changedetection.io-0.45.7.2-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.7.3":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.7.3/","requires_dist":["eventlet (>=0.33.3)","feedgen (~=0.9)","flask-compress","flask-login (>=0.6.3)","flask-paginate","flask-expects-json (~=1.7)","flask-restful","flask-wtf (~=1.2)","flask (~=2.3)","inscriptis (~=2.2)","pytz","timeago (~=1.0)","validators (~=0.21)","brotli (~=1.0)","requests[socks]","urllib3 (>1.26)","chardet (>2.3.0)","wtforms (~=3.0)","jsonpath-ng (~=1.5.3)","dnspython (~=2.4)","apprise (~=1.6.0)","paho-mqtt","cryptography (~=3.4)","beautifulsoup4","lxml","selenium (~=4.14.0)","werkzeug (~=3.0)","jinja2 (~=3.1)","jinja2-time","openpyxl","pillow","pytest (~=7.2)","pytest-flask (~=1.2)","jsonschema (==4.17.3)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.7","summary":"Website change detection and monitoring service","version":"0.45.7.3","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"b6523982613642f774f8cee8e2340275f1332ebe0d0a8c5946927725d105c1bf","md5":"b280d62097714279a8a3a76d17b3c46b","sha256":"bf6a21ffcf3e9487f014ce733e9796cc345b184d2e50919eba9a176f346a822d"},"downloads":-1,"filename":"changedetection.io-0.45.7.3-py3-none-any.whl","has_sig":false,"md5_digest":"b280d62097714279a8a3a76d17b3c46b","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.7","size":667199,"upload_time":"2023-11-12T11:15:17","upload_time_iso_8601":"2023-11-12T11:15:17.376303Z","url":"https://files.pythonhosted.org/packages/b6/52/3982613642f774f8cee8e2340275f1332ebe0d0a8c5946927725d105c1bf/changedetection.io-0.45.7.3-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.8":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.8/","requires_dist":["eventlet (>=0.33.3)","feedgen (~=0.9)","flask-compress","flask-login (>=0.6.3)","flask-paginate","flask-expects-json (~=1.7)","flask-restful","flask-wtf (~=1.2)","flask (~=2.3)","inscriptis (~=2.2)","pytz","timeago (~=1.0)","validators (~=0.21)","brotli (~=1.0)","requests[socks]","urllib3 (>1.26)","chardet (>2.3.0)","wtforms (~=3.0)","jsonpath-ng (~=1.5.3)","dnspython (~=2.4)","apprise (~=1.6.0)","paho-mqtt","cryptography (~=3.4)","beautifulsoup4","lxml","elementpath","selenium (~=4.14.0)","werkzeug (~=3.0)","jinja2 (~=3.1)","jinja2-time","openpyxl","pillow","pytest (~=7.2)","pytest-flask (~=1.2)","jsonschema (==4.17.3)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.7","summary":"Website change detection and monitoring service","version":"0.45.8","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"5eef5435ab7431e9483b500679100fcdb15cf8d325da73ca7bc773ec8a3e54c3","md5":"c8634411fcab80c7017c1f100e312a7e","sha256":"ed1113da47d30753dc8a1fa8e974b7b54655d1a841f2f0285248f06f5ee39094"},"downloads":-1,"filename":"changedetection.io-0.45.8-py3-none-any.whl","has_sig":false,"md5_digest":"c8634411fcab80c7017c1f100e312a7e","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.7","size":682190,"upload_time":"2023-11-29T09:29:39","upload_time_iso_8601":"2023-11-29T09:29:39.438755Z","url":"https://files.pythonhosted.org/packages/5e/ef/5435ab7431e9483b500679100fcdb15cf8d325da73ca7bc773ec8a3e54c3/changedetection.io-0.45.8-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.8.1":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.8.1/","requires_dist":["eventlet (>=0.33.3)","feedgen (~=0.9)","flask-compress","flask-login (>=0.6.3)","flask-paginate","flask-expects-json (~=1.7)","flask-restful","flask-wtf (~=1.2)","flask (~=2.3)","inscriptis (~=2.2)","pytz","timeago (~=1.0)","validators (~=0.21)","brotli (~=1.0)","requests[socks]","urllib3 (>1.26)","chardet (>2.3.0)","wtforms (~=3.0)","jsonpath-ng (~=1.5.3)","dnspython (~=2.4)","apprise (~=1.6.0)","paho-mqtt","cryptography (~=3.4)","beautifulsoup4","lxml","elementpath","selenium (~=4.14.0)","werkzeug (~=3.0)","jinja2 (~=3.1)","jinja2-time","openpyxl","pillow","pytest (~=7.2)","pytest-flask (~=1.2)","jsonschema (==4.17.3)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.7","summary":"Website change detection and monitoring service","version":"0.45.8.1","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"8db52e48942a3cd1710a18ac803faddf793104a103662fb464b300ef73c25af3","md5":"7b5295f705f6897f853b44451ae4b971","sha256":"5b1da6e53b9ef76817e404ba4d8e6b63d5192de469d0496ea751b304e3b03269"},"downloads":-1,"filename":"changedetection.io-0.45.8.1-py3-none-any.whl","has_sig":false,"md5_digest":"7b5295f705f6897f853b44451ae4b971","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.7","size":682153,"upload_time":"2023-12-10T09:41:49","upload_time_iso_8601":"2023-12-10T09:41:49.786038Z","url":"https://files.pythonhosted.org/packages/8d/b5/2e48942a3cd1710a18ac803faddf793104a103662fb464b300ef73c25af3/changedetection.io-0.45.8.1-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.45.9":{"info":{"author":"dgtlmoon","author_email":"","bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":"","maintainer_email":"","name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.45.9/","requires_dist":["eventlet (>=0.33.3)","feedgen (~=0.9)","flask-compress","flask-login (>=0.6.3)","flask-paginate","flask-expects-json (~=1.7)","flask-restful","flask-wtf (~=1.2)","flask (~=2.3)","inscriptis (~=2.2)","pytz","timeago (~=1.0)","validators (~=0.21)","brotli (~=1.0)","requests[socks]","urllib3 (>1.26)","chardet (>2.3.0)","wtforms (~=3.0)","jsonpath-ng (~=1.5.3)","dnspython (~=2.4)","apprise (~=1.6.0)","paho-mqtt","cryptography (~=3.4)","beautifulsoup4","lxml","elementpath","selenium (~=4.14.0)","werkzeug (~=3.0)","jinja2 (~=3.1)","jinja2-time","openpyxl","pillow","pytest (~=7.2)","pytest-flask (~=1.2)","jsonschema (==4.17.3)","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq (~=1.3) ; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">= 3.7","summary":"Website change detection and monitoring service","version":"0.45.9","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"1cce8c2a4cabb98fabeb569b4704217bbbd13cb61a6b68c9d307073b0bc33c5e","md5":"17fcdea76293aa62eeb9c3c819d42bfa","sha256":"bf80ef4e869523884d5c85ed96b07f4490e69e09e53be130cbe5def3d60d8542"},"downloads":-1,"filename":"changedetection.io-0.45.9-py3-none-any.whl","has_sig":false,"md5_digest":"17fcdea76293aa62eeb9c3c819d42bfa","packagetype":"bdist_wheel","python_version":"py3","requires_python":">= 3.7","size":682932,"upload_time":"2023-12-20T14:35:31","upload_time_iso_8601":"2023-12-20T14:35:31.182105Z","url":"https://files.pythonhosted.org/packages/1c/ce/8c2a4cabb98fabeb569b4704217bbbd13cb61a6b68c9d307073b0bc33c5e/changedetection.io-0.45.9-py3-none-any.whl","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-23329"],"details":"### Summary\n\nAPI endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user.\n\n### Details\n\nWatchHistory resource does not have `@auth.check_token` annotation, which means it can be accessed without providing `x-api-key` header.\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/9510345e01ea8e308c339163d8e8b030ce5ac7f1/changedetectionio/api/api_v1.py#L129-L156\n\n### PoC\n\n1. Get list of watch with `x-api-key`:\n```sh\n$ curl -H \"x-api-key: apikeyhere\" http://localhost:5000/api/v1/watch\n{\"uuid\": ...}\n```\n2. Call for history of snapshots without `x-api-key`. Expected - 401/403 error. Actual - list of snapshots is listed.\n```sh\n$ curl http://localhost:5000/api/v1/watch/uuid/history\n{\"timestamp\": \"/path/to/snapshot.txt\"}\n```\n\n### Impact\n\nAnybody can check one's watch history. However, because unauthorized party first needs to know watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal.\n","fixed_in":["0.45.13","0.45.13"],"id":"GHSA-hcvp-2cc7-jrwr","link":"https://osv.dev/vulnerability/GHSA-hcvp-2cc7-jrwr","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-23329","GHSA-hcvp-2cc7-jrwr"],"details":" changedetection.io is an open source tool designed to monitor websites for content changes. In affected versions the API endpoint `/api/v1/watch/<uuid>/history` can be accessed by any unauthorized user. As a result any unauthorized user can check one's watch history. However, because unauthorized party first needs to know a watch UUID, and the watch history endpoint itself returns only paths to the snapshot on the server, an impact on users' data privacy is minimal. This issue has been addressed in version 0.45.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.","fixed_in":["0.45.13"],"id":"PYSEC-2024-15","link":"https://osv.dev/vulnerability/PYSEC-2024-15","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-34061"],"details":"### Summary\n\nInput in parameter notification_urls is not processed resulting in javascript execution in the application\n\n### Details\nchangedetection.io version: v0.45.21\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/0.45.21/changedetectionio/forms.py#L226\n\n```\n        for server_url in field.data:\n            if not apobj.add(server_url):\n                message = field.gettext('\\'%s\\' is not a valid AppRise URL.' % (server_url))\n                raise ValidationError(message)\n```\n\n### PoC\n\nSetting > ADD Notification URL List\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/626eb43b-a414-4b05-92d8-c7345c2a2e75)\n\n\n```\n\"><img src=x onerror=alert(document.domain)>\n```\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/476bd396-2aa2-4642-9c54-fd2c2ef9de79)\n\nRequests\n\n![image](https://github.com/dgtlmoon/changedetection.io/assets/65381453/1f258ef1-149a-4a03-88ab-a2244a69652e)\n\n\n### Impact\nA reflected XSS vulnerability happens when the user input from a URL or POST data is reflected on the page without being stored, thus allowing the attacker to inject malicious content\n","fixed_in":["0.45.22"],"id":"GHSA-pwgc-w4x9-gw67","link":"https://osv.dev/vulnerability/GHSA-pwgc-w4x9-gw67","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-32651"],"details":"### Summary\nA Server Side Template Injection in changedetection.io caused by usage of unsafe functions of Jinja2 allows Remote Command Execution on the server host.\n\n### Details\n\nchangedetection.io version: 0.45.20\n```\ndocker images\nREPOSITORY                            TAG       IMAGE ID       CREATED        SIZE\ndgtlmoon/changedetection.io           latest    53529c2e69f1   44 hours ago   423MB\n```\n\nThe vulnerability is caused by the usage of vulnerable functions of Jinja2 template engine.\n```python\nfrom jinja2 import Environment, BaseLoader\n...\n    # Get the notification body from datastore\n    jinja2_env = Environment(loader=BaseLoader)\n    n_body = jinja2_env.from_string(n_object.get('notification_body', '')).render(**notification_parameters)\n    n_title = jinja2_env.from_string(n_object.get('notification_title', '')).render(**notification_parameters)\n```\n\n\n### PoC\n1. Create/Edit a URL watch item\n2. Under *Notifications* tab insert this payload: \n```python\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n```\n![Screenshot from 2024-04-19 15-46-04](https://github.com/dgtlmoon/changedetection.io/assets/35783570/b6a5779f-fd1e-4708-9b2d-21cb97f0bb4f)\n\n3. See Telegram (or other supported messaging app) notification\n\n![Screenshot from 2024-04-19 16-02-12](https://github.com/dgtlmoon/changedetection.io/assets/35783570/20877919-d6fe-49f1-bbd2-586e900207f1)\n\n\n### Impact\nIn the PoC I've used `id` as payload and Telegram to read the result.  \nAttackers can run any system command without any restriction and they don't need to read the result in the notification app (e.g. they could use a reverse shell).\nThe impact is critical as the attacker can completely takeover the server host.\nThis can be reduced if changedetection access is protected by login page with a password, but this isn't required by the application (not by default and not enforced).\n\n### References\n- https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/\n- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti\n- https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/\n- https://docs.cobalt.io/bestpractices/prevent-ssti/\n\n### Credits\n\nEdoardo Ottavianelli","fixed_in":["0.45.21"],"id":"GHSA-4r7v-whpg-8rx3","link":"https://osv.dev/vulnerability/GHSA-4r7v-whpg-8rx3","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.46.0":{"info":{"author":"dgtlmoon","author_email":null,"bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":null,"downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":null,"maintainer_email":null,"name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.46.0/","requires_dist":["pyee","eventlet>=0.36.1","feedgen~=0.9","flask-compress","flask-login>=0.6.3","flask-paginate","flask-expects-json~=1.7","flask-restful","flask-cors","flask-wtf~=1.2","flask~=2.3","inscriptis~=2.2","pytz","timeago~=1.0","validators~=0.21","brotli~=1.0","requests[socks]","requests-file","urllib3==1.26.19","chardet>2.3.0","wtforms~=3.0","jsonpath-ng~=1.5.3","dnspython==2.6.1","apprise~=1.8.0","paho-mqtt<2.0.0,>=1.6.1","cryptography~=42.0.8","beautifulsoup4","lxml!=5.2.0,!=5.2.1,<6,>=4.8.0","elementpath==4.1.5","selenium~=4.14.0","werkzeug~=3.0","jinja2~=3.1","jinja2-time","openpyxl","pyppeteer-ng==2.0.0rc5","pyppeteerstealth>=0.0.4","pytest~=7.2","pytest-flask~=1.2","jsonschema==4.17.3","loguru","extruct","babel","greenlet>=3.0.3","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">=3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.46.0","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"37f159fab86df4718db42c58a515948f24f7572ab3871c7fecbc6b36ed69d359","md5":"b170e511dee2e77f41fd25d902ca398f","sha256":"caf5589cb79beef9c896907af5534863ffcad12d9e91a92d194003def4644efe"},"downloads":-1,"filename":"changedetection.io-0.46.0-py3-none-any.whl","has_sig":false,"md5_digest":"b170e511dee2e77f41fd25d902ca398f","packagetype":"bdist_wheel","python_version":"py3","requires_python":">=3.10","size":660092,"upload_time":"2024-07-18T12:14:47","upload_time_iso_8601":"2024-07-18T12:14:47.572462Z","url":"https://files.pythonhosted.org/packages/37/f1/59fab86df4718db42c58a515948f24f7572ab3871c7fecbc6b36ed69d359/changedetection.io-0.46.0-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"976bfb792b3be36e3e7a5d97c1b4ca0d2f2b2e206bd6c8180b1f10ea36e5136d","md5":"0ebbd33a8d1403d882bbc533658e1d96","sha256":"2f9f299cacd7d1c457658b82f25d18614891f3ad148cb1b8565d82bd8573a083"},"downloads":-1,"filename":"changedetection_io-0.46.0.tar.gz","has_sig":false,"md5_digest":"0ebbd33a8d1403d882bbc533658e1d96","packagetype":"sdist","python_version":"source","requires_python":">=3.10","size":561142,"upload_time":"2024-07-18T12:14:50","upload_time_iso_8601":"2024-07-18T12:14:50.686831Z","url":"https://files.pythonhosted.org/packages/97/6b/fb792b3be36e3e7a5d97c1b4ca0d2f2b2e206bd6c8180b1f10ea36e5136d/changedetection_io-0.46.0.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.46.1":{"info":{"author":"dgtlmoon","author_email":null,"bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":null,"downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":null,"maintainer_email":null,"name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.46.1/","requires_dist":["pyee","eventlet>=0.36.1","feedgen~=0.9","flask-compress","flask-login>=0.6.3","flask-paginate","flask-expects-json~=1.7","flask-restful","flask-cors","flask-wtf~=1.2","flask~=2.3","inscriptis~=2.2","pytz","timeago~=1.0","validators~=0.21","brotli~=1.0","requests[socks]","requests-file","urllib3==1.26.19","chardet>2.3.0","wtforms~=3.0","jsonpath-ng~=1.5.3","dnspython==2.6.1","apprise~=1.8.0","paho-mqtt<2.0.0,>=1.6.1","cryptography~=42.0.8","beautifulsoup4","lxml!=5.2.0,!=5.2.1,<6,>=4.8.0","elementpath==4.1.5","selenium~=4.14.0","werkzeug~=3.0","jinja2~=3.1","jinja2-time","openpyxl","pyppeteer-ng==2.0.0rc5","pyppeteerstealth>=0.0.4","pytest~=7.2","pytest-flask~=1.2","jsonschema==4.17.3","loguru","extruct","babel","greenlet>=3.0.3","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">=3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.46.1","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"4f9e928ce96845a58ab486a722ec561abd59d40b144953adb6f65895e7232829","md5":"05e23c4770b325f108f83f904dc63bbe","sha256":"9e9138d1cbbe47dea101b2aa5fbae75d2024c955d699c5c3247998b890022344"},"downloads":-1,"filename":"changedetection.io-0.46.1-py3-none-any.whl","has_sig":false,"md5_digest":"05e23c4770b325f108f83f904dc63bbe","packagetype":"bdist_wheel","python_version":"py3","requires_python":">=3.10","size":660500,"upload_time":"2024-07-19T11:54:40","upload_time_iso_8601":"2024-07-19T11:54:40.769295Z","url":"https://files.pythonhosted.org/packages/4f/9e/928ce96845a58ab486a722ec561abd59d40b144953adb6f65895e7232829/changedetection.io-0.46.1-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"01efa2333d3ecb9ee6e63063776e9729406c03eefdaaf62a1a319bf0f4c23499","md5":"9faaf85ef1db7949bb8aa2cf8e1b1489","sha256":"def80e6db41fc7fb9b7bb119db203c7b6026b7e8acffddb1144393463abbc232"},"downloads":-1,"filename":"changedetection_io-0.46.1.tar.gz","has_sig":false,"md5_digest":"9faaf85ef1db7949bb8aa2cf8e1b1489","packagetype":"sdist","python_version":"source","requires_python":">=3.10","size":561576,"upload_time":"2024-07-19T11:54:43","upload_time_iso_8601":"2024-07-19T11:54:43.072894Z","url":"https://files.pythonhosted.org/packages/01/ef/a2333d3ecb9ee6e63063776e9729406c03eefdaaf62a1a319bf0f4c23499/changedetection_io-0.46.1.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.46.2":{"info":{"author":"dgtlmoon","author_email":null,"bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":null,"downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":null,"maintainer_email":null,"name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.46.2/","requires_dist":["pyee","eventlet>=0.36.1","feedgen~=0.9","flask-compress","flask-login>=0.6.3","flask-paginate","flask-expects-json~=1.7","flask-restful","flask-cors","flask-wtf~=1.2","flask~=2.3","inscriptis~=2.2","pytz","timeago~=1.0","validators~=0.21","brotli~=1.0","requests[socks]","requests-file","urllib3==1.26.19","chardet>2.3.0","wtforms~=3.0","jsonpath-ng~=1.5.3","dnspython==2.6.1","apprise~=1.8.1","paho-mqtt<2.0.0,>=1.6.1","cryptography~=42.0.8","beautifulsoup4","lxml!=5.2.0,!=5.2.1,<6,>=4.8.0","elementpath==4.1.5","selenium~=4.14.0","werkzeug~=3.0","jinja2~=3.1","jinja2-time","openpyxl","pyppeteer-ng==2.0.0rc5","pyppeteerstealth>=0.0.4","pytest~=7.2","pytest-flask~=1.2","jsonschema==4.17.3","loguru","extruct","babel","greenlet>=3.0.3","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">=3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.46.2","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"58c2406cde2fac37be8621fd77b4b9727edceb152bf20e67abfc544bd7ff383f","md5":"068cc53e951da365a0efc69b2590f066","sha256":"92cf8936256f367621ab3e510d3ae1edcd86d0d0161fc8a489773f3ab2be5d44"},"downloads":-1,"filename":"changedetection.io-0.46.2-py3-none-any.whl","has_sig":false,"md5_digest":"068cc53e951da365a0efc69b2590f066","packagetype":"bdist_wheel","python_version":"py3","requires_python":">=3.10","size":661272,"upload_time":"2024-07-27T18:29:51","upload_time_iso_8601":"2024-07-27T18:29:51.324065Z","url":"https://files.pythonhosted.org/packages/58/c2/406cde2fac37be8621fd77b4b9727edceb152bf20e67abfc544bd7ff383f/changedetection.io-0.46.2-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"db271a0e5741637a19981a1d27ad1142064e6f48ff92a0da45ac8e4b9bb05a1c","md5":"737904715d6f31b873f0eb737e215488","sha256":"09e6ff294a34039e1028d905cf2b537af88afdb128bfe5b1afde63609450274d"},"downloads":-1,"filename":"changedetection_io-0.46.2.tar.gz","has_sig":false,"md5_digest":"737904715d6f31b873f0eb737e215488","packagetype":"sdist","python_version":"source","requires_python":">=3.10","size":562057,"upload_time":"2024-07-27T18:29:53","upload_time_iso_8601":"2024-07-27T18:29:53.682628Z","url":"https://files.pythonhosted.org/packages/db/27/1a0e5741637a19981a1d27ad1142064e6f48ff92a0da45ac8e4b9bb05a1c/changedetection_io-0.46.2.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.46.3":{"info":{"author":"dgtlmoon","author_email":null,"bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":null,"downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":null,"maintainer_email":null,"name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.46.3/","requires_dist":["pyee","eventlet>=0.36.1","feedgen~=0.9","flask-compress","flask-login>=0.6.3","flask-paginate","flask-expects-json~=1.7","flask-restful","flask-cors","flask-wtf~=1.2","flask~=2.3","inscriptis~=2.2","pytz","timeago~=1.0","validators~=0.21","brotli~=1.0","requests[socks]","requests-file","urllib3==1.26.19","chardet>2.3.0","wtforms~=3.0","jsonpath-ng~=1.5.3","dnspython==2.6.1","apprise~=1.8.1","paho-mqtt<2.0.0,>=1.6.1","cryptography~=42.0.8","beautifulsoup4","lxml!=5.2.0,!=5.2.1,<6,>=4.8.0","elementpath==4.1.5","selenium~=4.14.0","werkzeug~=3.0","jinja2~=3.1","jinja2-time","openpyxl","pyppeteer-ng==2.0.0rc5","pyppeteerstealth>=0.0.4","pytest~=7.2","pytest-flask~=1.2","jsonschema==4.17.3","loguru","extruct","babel","greenlet>=3.0.3","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">=3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.46.3","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"1a8583ef369c46c5e2239e18f2509d5ada137b89347518655d4149ee35c81734","md5":"6d5b30ee0a4f59130e312eca40f540ba","sha256":"d8d7fa1986f74020b2ac771147e2f84afe21c79efefe27f74809231d820b2210"},"downloads":-1,"filename":"changedetection.io-0.46.3-py3-none-any.whl","has_sig":false,"md5_digest":"6d5b30ee0a4f59130e312eca40f540ba","packagetype":"bdist_wheel","python_version":"py3","requires_python":">=3.10","size":661659,"upload_time":"2024-08-19T15:23:56","upload_time_iso_8601":"2024-08-19T15:23:56.508499Z","url":"https://files.pythonhosted.org/packages/1a/85/83ef369c46c5e2239e18f2509d5ada137b89347518655d4149ee35c81734/changedetection.io-0.46.3-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"d12edd3bff7776952fa8a407f822f521919ed93c07cd4a5c7120cb46d396f07b","md5":"c19edc201b07f64524a0296eafebb273","sha256":"b0e9ca3fb4f639c7ace84f5d18e99ad8391afff270ae486cfae6041b52651240"},"downloads":-1,"filename":"changedetection_io-0.46.3.tar.gz","has_sig":false,"md5_digest":"c19edc201b07f64524a0296eafebb273","packagetype":"sdist","python_version":"source","requires_python":">=3.10","size":562599,"upload_time":"2024-08-19T15:23:58","upload_time_iso_8601":"2024-08-19T15:23:58.282190Z","url":"https://files.pythonhosted.org/packages/d1/2e/dd3bff7776952fa8a407f822f521919ed93c07cd4a5c7120cb46d396f07b/changedetection_io-0.46.3.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.46.4":{"info":{"author":"dgtlmoon","author_email":null,"bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":null,"downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":null,"maintainer_email":null,"name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.46.4/","requires_dist":["pyee","eventlet>=0.36.1","feedgen~=0.9","flask-compress","flask-login>=0.6.3","flask-paginate","flask-expects-json~=1.7","flask-restful","flask-cors","flask-wtf~=1.2","flask~=2.3","inscriptis~=2.2","pytz","timeago~=1.0","validators~=0.21","brotli~=1.0","requests[socks]","requests-file","urllib3==1.26.19","chardet>2.3.0","wtforms~=3.0","jsonpath-ng~=1.5.3","dnspython==2.6.1","apprise~=1.8.1","paho-mqtt<2.0.0,>=1.6.1","cryptography~=42.0.8","beautifulsoup4","lxml!=5.2.0,!=5.2.1,<6,>=4.8.0","elementpath==4.1.5","selenium~=4.14.0","werkzeug~=3.0","jinja2~=3.1","jinja2-time","openpyxl","pyppeteer-ng==2.0.0rc5","pyppeteerstealth>=0.0.4","pytest~=7.2","pytest-flask~=1.2","jsonschema~=4.0","loguru","extruct","babel","greenlet>=3.0.3","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">=3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.46.4","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"8296f7cc907a43730a983c06e45af5edf9d5986788b08f37d7ef910e662dcf8a","md5":"94ea920b418daf9445c8ede1708c02e8","sha256":"dc913fabc594a5d62b8a9504d184bdc84cae08ad53eb173dfc5f1a0ece4106d5"},"downloads":-1,"filename":"changedetection.io-0.46.4-py3-none-any.whl","has_sig":false,"md5_digest":"94ea920b418daf9445c8ede1708c02e8","packagetype":"bdist_wheel","python_version":"py3","requires_python":">=3.10","size":662195,"upload_time":"2024-09-04T11:57:03","upload_time_iso_8601":"2024-09-04T11:57:03.376328Z","url":"https://files.pythonhosted.org/packages/82/96/f7cc907a43730a983c06e45af5edf9d5986788b08f37d7ef910e662dcf8a/changedetection.io-0.46.4-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"8eea5c36a3d55231a400cb74f36a2390f34a167f85c9f2e23c6a7ecaa666b140","md5":"22c9f5695d813bc1076b32f341cf8972","sha256":"672ddc19b37be29f9f2e6c6b42669218bc180fbdee57537493cc76e93b27d8f6"},"downloads":-1,"filename":"changedetection_io-0.46.4.tar.gz","has_sig":false,"md5_digest":"22c9f5695d813bc1076b32f341cf8972","packagetype":"sdist","python_version":"source","requires_python":">=3.10","size":563258,"upload_time":"2024-09-04T11:57:05","upload_time_iso_8601":"2024-09-04T11:57:05.012277Z","url":"https://files.pythonhosted.org/packages/8e/ea/5c36a3d55231a400cb74f36a2390f34a167f85c9f2e23c6a7ecaa666b140/changedetection_io-0.46.4.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.47.0":{"info":{"author":"dgtlmoon","author_email":null,"bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":null,"downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":null,"maintainer_email":null,"name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.47.0/","requires_dist":["pyee","eventlet>=0.36.1","feedgen~=0.9","flask-compress","flask-login>=0.6.3","flask-paginate","flask-expects-json~=1.7","flask-restful","flask-cors","flask-wtf~=1.2","flask~=2.3","inscriptis~=2.2","pytz","timeago~=1.0","validators~=0.21","brotli~=1.0","requests[socks]","requests-file","urllib3==1.26.19","chardet>2.3.0","wtforms~=3.0","jsonpath-ng~=1.5.3","dnspython==2.6.1","apprise==1.9.0","paho-mqtt<2.0.0,>=1.6.1","cryptography~=42.0.8","beautifulsoup4","lxml!=5.2.0,!=5.2.1,<6,>=4.8.0","elementpath==4.1.5","selenium~=4.14.0","werkzeug~=3.0","jinja2~=3.1","jinja2-time","openpyxl","pyppeteer-ng==2.0.0rc5","pyppeteerstealth>=0.0.4","pytest~=7.2","pytest-flask~=1.2","jsonschema~=4.0","loguru","extruct","babel","greenlet>=3.0.3","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">=3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.47.0","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"0d6ea4cd828aec27bce2cf0d61a32f90cf96cd15954b4b50747d844103690497","md5":"d508ec0ec81c435503df3919567f9df9","sha256":"004a9304d517a839c156bf496bcd0c8d6d18c0c62f056f8ce98d393e27609d8c"},"downloads":-1,"filename":"changedetection.io-0.47.0-py3-none-any.whl","has_sig":false,"md5_digest":"d508ec0ec81c435503df3919567f9df9","packagetype":"bdist_wheel","python_version":"py3","requires_python":">=3.10","size":676602,"upload_time":"2024-10-11T11:06:40","upload_time_iso_8601":"2024-10-11T11:06:40.712396Z","url":"https://files.pythonhosted.org/packages/0d/6e/a4cd828aec27bce2cf0d61a32f90cf96cd15954b4b50747d844103690497/changedetection.io-0.47.0-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"b644c09e257f2eff17a8f1f2686a05b84d4f37453697fb10d54e04166f82220c","md5":"5dc1cc2e2e5db7dab2b294f375ca5bd2","sha256":"0cdcd126f78b2489204c65b9c1550ce239030e7297e5eff20578eff4f5468b14"},"downloads":-1,"filename":"changedetection_io-0.47.0.tar.gz","has_sig":false,"md5_digest":"5dc1cc2e2e5db7dab2b294f375ca5bd2","packagetype":"sdist","python_version":"source","requires_python":">=3.10","size":575010,"upload_time":"2024-10-11T11:06:42","upload_time_iso_8601":"2024-10-11T11:06:42.954124Z","url":"https://files.pythonhosted.org/packages/b6/44/c09e257f2eff17a8f1f2686a05b84d4f37453697fb10d54e04166f82220c/changedetection_io-0.47.0.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.47.1":{"info":{"author":"dgtlmoon","author_email":null,"bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":null,"downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":null,"maintainer_email":null,"name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.47.1/","requires_dist":["pyee","eventlet>=0.36.1","feedgen~=0.9","flask-compress","flask-login>=0.6.3","flask-paginate","flask-expects-json~=1.7","flask-restful","flask-cors","flask-wtf~=1.2","flask~=2.3","inscriptis~=2.2","pytz","timeago~=1.0","validators~=0.21","brotli~=1.0","requests[socks]","requests-file","urllib3==1.26.19","chardet>2.3.0","wtforms~=3.0","jsonpath-ng~=1.5.3","dnspython==2.6.1","apprise==1.9.0","paho-mqtt<2.0.0,>=1.6.1","cryptography~=42.0.8","beautifulsoup4","lxml!=5.2.0,!=5.2.1,<6,>=4.8.0","elementpath==4.1.5","selenium~=4.14.0","werkzeug~=3.0","jinja2~=3.1","jinja2-time","openpyxl","pyppeteer-ng==2.0.0rc5","pyppeteerstealth>=0.0.4","pytest~=7.2","pytest-flask~=1.2","jsonschema~=4.0","loguru","extruct","babel","greenlet>=3.0.3","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">=3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.47.1","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"822562b9f004a5696031fd54f02f571715214728b5a74b4a5218cbe134eaba1b","md5":"a865e469c0c14c464418afacb38b1cd7","sha256":"01a4648682ae73632a4f7a8d1041c0ed6f830222f0b2d16747ee53188d704092"},"downloads":-1,"filename":"changedetection.io-0.47.1-py3-none-any.whl","has_sig":false,"md5_digest":"a865e469c0c14c464418afacb38b1cd7","packagetype":"bdist_wheel","python_version":"py3","requires_python":">=3.10","size":677905,"upload_time":"2024-10-11T13:04:18","upload_time_iso_8601":"2024-10-11T13:04:18.622563Z","url":"https://files.pythonhosted.org/packages/82/25/62b9f004a5696031fd54f02f571715214728b5a74b4a5218cbe134eaba1b/changedetection.io-0.47.1-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"b00f1da010937425354ac69ad41248a04270da7ee39dbb7d7167901900c8426e","md5":"0096589687ce7a5495d16d98b1e6473b","sha256":"14cc23cb36a4ccef31777b94eecbf20fc29fb6165a3742b75de832c1dff8cf04"},"downloads":-1,"filename":"changedetection_io-0.47.1.tar.gz","has_sig":false,"md5_digest":"0096589687ce7a5495d16d98b1e6473b","packagetype":"sdist","python_version":"source","requires_python":">=3.10","size":576387,"upload_time":"2024-10-11T13:04:20","upload_time_iso_8601":"2024-10-11T13:04:20.623987Z","url":"https://files.pythonhosted.org/packages/b0/0f/1da010937425354ac69ad41248a04270da7ee39dbb7d7167901900c8426e/changedetection_io-0.47.1.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.47.2":{"info":{"author":"dgtlmoon","author_email":null,"bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":null,"downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":null,"maintainer_email":null,"name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.47.2/","requires_dist":["pyee","eventlet>=0.36.1","feedgen~=0.9","flask-compress","flask-login>=0.6.3","flask-paginate","flask-expects-json~=1.7","flask-restful","flask-cors","flask-wtf~=1.2","flask~=2.3","inscriptis~=2.2","pytz","timeago~=1.0","validators~=0.21","brotli~=1.0","requests[socks]","requests-file","urllib3==1.26.19","chardet>2.3.0","wtforms~=3.0","jsonpath-ng~=1.5.3","dnspython==2.6.1","apprise==1.9.0","paho-mqtt<2.0.0,>=1.6.1","cryptography~=42.0.8","beautifulsoup4","lxml!=5.2.0,!=5.2.1,<6,>=4.8.0","elementpath==4.1.5","selenium~=4.14.0","werkzeug~=3.0","jinja2~=3.1","jinja2-time","openpyxl","pyppeteer-ng==2.0.0rc5","pyppeteerstealth>=0.0.4","pytest~=7.2","pytest-flask~=1.2","jsonschema~=4.0","loguru","extruct","babel","greenlet>=3.0.3","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">=3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.47.2","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"c6248dd2cfdd8d4db6e38e27e58edc9ceab8e762aeab8baad03eb23a6e2ef5ca","md5":"f3eeef195c51336a5d1063b8424cb095","sha256":"97a059750621b69834bc39ad468ba564b2d79f5c73fc50362d1468490faa2410"},"downloads":-1,"filename":"changedetection.io-0.47.2-py3-none-any.whl","has_sig":false,"md5_digest":"f3eeef195c51336a5d1063b8424cb095","packagetype":"bdist_wheel","python_version":"py3","requires_python":">=3.10","size":677975,"upload_time":"2024-10-11T13:37:20","upload_time_iso_8601":"2024-10-11T13:37:20.249732Z","url":"https://files.pythonhosted.org/packages/c6/24/8dd2cfdd8d4db6e38e27e58edc9ceab8e762aeab8baad03eb23a6e2ef5ca/changedetection.io-0.47.2-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"25cfcb38095f6b1d32244d467420aec5ba5a2c47c88fcfa86a998fb7f3c5ec8d","md5":"bbfb32499ff89be4db3667058edb280b","sha256":"8bd454cf6c0a85fea70c3646c5bc0be5cd19d3409a286661e797478295e8bfa2"},"downloads":-1,"filename":"changedetection_io-0.47.2.tar.gz","has_sig":false,"md5_digest":"bbfb32499ff89be4db3667058edb280b","packagetype":"sdist","python_version":"source","requires_python":">=3.10","size":576421,"upload_time":"2024-10-11T13:37:22","upload_time_iso_8601":"2024-10-11T13:37:22.089610Z","url":"https://files.pythonhosted.org/packages/25/cf/cb38095f6b1d32244d467420aec5ba5a2c47c88fcfa86a998fb7f3c5ec8d/changedetection_io-0.47.2.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.47.3":{"info":{"author":"dgtlmoon","author_email":null,"bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":null,"downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":null,"maintainer_email":null,"name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.47.3/","requires_dist":["pyee","eventlet>=0.36.1","feedgen~=0.9","flask-compress","flask-login>=0.6.3","flask-paginate","flask-expects-json~=1.7","flask-restful","flask-cors","flask-wtf~=1.2","flask~=2.3","inscriptis~=2.2","pytz","timeago~=1.0","validators~=0.21","brotli~=1.0","requests[socks]","requests-file","urllib3==1.26.19","chardet>2.3.0","wtforms~=3.0","jsonpath-ng~=1.5.3","dnspython==2.6.1","apprise==1.9.0","paho-mqtt<2.0.0,>=1.6.1","cryptography~=42.0.8","beautifulsoup4","lxml!=5.2.0,!=5.2.1,<6,>=4.8.0","elementpath==4.1.5","selenium~=4.14.0","werkzeug~=3.0","jinja2~=3.1","jinja2-time","openpyxl","pyppeteer-ng==2.0.0rc5","pyppeteerstealth>=0.0.4","pytest~=7.2","pytest-flask~=1.2","jsonschema~=4.0","loguru","extruct","babel","greenlet>=3.0.3","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">=3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.47.3","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"b66ee469d53b511ad1a23bacd040781c6eb0b2555f0a6a633756172fd262d7c8","md5":"0390df4e1bfdb8301fc13600f091c90c","sha256":"edebe502d6305f932aac315564965c858c19409e1eceedddc16cf0a17a06bfd3"},"downloads":-1,"filename":"changedetection.io-0.47.3-py3-none-any.whl","has_sig":false,"md5_digest":"0390df4e1bfdb8301fc13600f091c90c","packagetype":"bdist_wheel","python_version":"py3","requires_python":">=3.10","size":677708,"upload_time":"2024-10-11T15:34:50","upload_time_iso_8601":"2024-10-11T15:34:50.803354Z","url":"https://files.pythonhosted.org/packages/b6/6e/e469d53b511ad1a23bacd040781c6eb0b2555f0a6a633756172fd262d7c8/changedetection.io-0.47.3-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"e3a8cbd838a009eccd3e423b138294fd2286e7be6a783d80ffaabbe916af25c6","md5":"76c03fa57275912a573efc61d52ced5b","sha256":"5208e41c9e335f83883e722e3ef552c79aa40b18c8ccd8b03be2768a060aac87"},"downloads":-1,"filename":"changedetection_io-0.47.3.tar.gz","has_sig":false,"md5_digest":"76c03fa57275912a573efc61d52ced5b","packagetype":"sdist","python_version":"source","requires_python":">=3.10","size":576137,"upload_time":"2024-10-11T15:34:52","upload_time_iso_8601":"2024-10-11T15:34:52.871974Z","url":"https://files.pythonhosted.org/packages/e3/a8/cbd838a009eccd3e423b138294fd2286e7be6a783d80ffaabbe916af25c6/changedetection_io-0.47.3.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.47.4":{"info":{"author":"dgtlmoon","author_email":null,"bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":null,"downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":null,"maintainer_email":null,"name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.47.4/","requires_dist":["pyee","eventlet>=0.36.1","feedgen~=0.9","flask-compress","flask-login>=0.6.3","flask-paginate","flask-expects-json~=1.7","flask-restful","flask-cors","flask-wtf~=1.2","flask~=2.3","inscriptis~=2.2","pytz","timeago~=1.0","validators~=0.21","brotli~=1.0","requests[socks]","requests-file","urllib3==1.26.19","chardet>2.3.0","wtforms~=3.0","jsonpath-ng~=1.5.3","dnspython==2.6.1","apprise==1.9.0","paho-mqtt<2.0.0,>=1.6.1","cryptography~=42.0.8","beautifulsoup4","lxml!=5.2.0,!=5.2.1,<6,>=4.8.0","elementpath==4.1.5","selenium~=4.14.0","werkzeug~=3.0","jinja2~=3.1","jinja2-time","openpyxl","pyppeteer-ng==2.0.0rc5","pyppeteerstealth>=0.0.4","pytest~=7.2","pytest-flask~=1.2","jsonschema~=4.0","loguru","extruct","babel","greenlet>=3.0.3","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">=3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.47.4","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"e11b14c7d4264a218168106be981df9c3ec954dc184c68aace28b8e185fb4635","md5":"851b9001cad9258b02d2ef30aece1bd3","sha256":"7129a81605a26ebfaabb2fef0270ce9e2b491e8af775daf16dd29d9f3c9df91d"},"downloads":-1,"filename":"changedetection.io-0.47.4-py3-none-any.whl","has_sig":false,"md5_digest":"851b9001cad9258b02d2ef30aece1bd3","packagetype":"bdist_wheel","python_version":"py3","requires_python":">=3.10","size":678856,"upload_time":"2024-10-29T07:26:52","upload_time_iso_8601":"2024-10-29T07:26:52.094665Z","url":"https://files.pythonhosted.org/packages/e1/1b/14c7d4264a218168106be981df9c3ec954dc184c68aace28b8e185fb4635/changedetection.io-0.47.4-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"30550e5fd45d6a47b3ade4d24f11131dd383ac72741a5ec6e7a6903f08404d38","md5":"a60cc0e78804442664530df225c89573","sha256":"4586f640c55124cba31b84728023965cbf7f7b634bf42c92cfaa570c10b87a5b"},"downloads":-1,"filename":"changedetection_io-0.47.4.tar.gz","has_sig":false,"md5_digest":"a60cc0e78804442664530df225c89573","packagetype":"sdist","python_version":"source","requires_python":">=3.10","size":577159,"upload_time":"2024-10-29T07:26:54","upload_time_iso_8601":"2024-10-29T07:26:54.324398Z","url":"https://files.pythonhosted.org/packages/30/55/0e5fd45d6a47b3ade4d24f11131dd383ac72741a5ec6e7a6903f08404d38/changedetection_io-0.47.4.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-51483"],"details":"### Summary\nWhen a WebDriver is used to fetch files source:file:///etc/passwd can be used to retrieve local system files, where the more traditional file:///etc/passwd gets blocked\n\n### Details\nThe root cause is the payload source:file:///etc/passwdpasses the regex [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/model/Watch.py#L19) and also passes the check [here](https://github.com/dgtlmoon/changedetection.io/blob/master/changedetectionio/processors/__init__.py#L35) where a traditional file:///etc/passwd would get blocked\n\n### PoC\n[CL-ChangeDetection.io Path Travsersal-311024-181039.pdf](https://github.com/user-attachments/files/17591630/CL-ChangeDetection.io.Path.Travsersal-311024-181039.pdf)\n\n\n\n### Impact\nIt depends on where the webdriver is deployed but generally this is a high impact vulnerability \n","fixed_in":["0.47.5"],"id":"GHSA-cwgg-57xj-g77r","link":"https://osv.dev/vulnerability/GHSA-cwgg-57xj-g77r","source":"osv","summary":null,"withdrawn":null},{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.47.5":{"info":{"author":"dgtlmoon","author_email":null,"bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":null,"downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":null,"maintainer_email":null,"name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.47.5/","requires_dist":["pyee","eventlet>=0.36.1","feedgen~=0.9","flask-compress","flask-login>=0.6.3","flask-paginate","flask-expects-json~=1.7","flask-restful","flask-cors","flask-wtf~=1.2","flask~=2.3","inscriptis~=2.2","pytz","timeago~=1.0","validators~=0.21","brotli~=1.0","requests[socks]","requests-file","urllib3==1.26.19","chardet>2.3.0","wtforms~=3.0","jsonpath-ng~=1.5.3","dnspython==2.6.1","apprise==1.9.0","paho-mqtt<2.0.0,>=1.6.1","cryptography~=42.0.8","beautifulsoup4","lxml!=5.2.0,!=5.2.1,<6,>=4.8.0","elementpath==4.1.5","selenium~=4.14.0","werkzeug~=3.0","jinja2~=3.1","jinja2-time","openpyxl","pyppeteer-ng==2.0.0rc5","pyppeteerstealth>=0.0.4","pytest~=7.2","pytest-flask~=1.2","jsonschema~=4.0","loguru","extruct","babel","greenlet>=3.0.3","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">=3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.47.5","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"e923ecd0cbcc3c36acb23888271055f5629df829878bc2e77d44e223347d7595","md5":"e2425a4173faace256fdf8d19ee1ba0a","sha256":"fcea800b9ba17115aefb73880c8d2b74e5113334a96e120adc02e84fa993905a"},"downloads":-1,"filename":"changedetection.io-0.47.5-py3-none-any.whl","has_sig":false,"md5_digest":"e2425a4173faace256fdf8d19ee1ba0a","packagetype":"bdist_wheel","python_version":"py3","requires_python":">=3.10","size":682146,"upload_time":"2024-10-31T21:52:51","upload_time_iso_8601":"2024-10-31T21:52:51.139267Z","url":"https://files.pythonhosted.org/packages/e9/23/ecd0cbcc3c36acb23888271055f5629df829878bc2e77d44e223347d7595/changedetection.io-0.47.5-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"8272c8337c24fd8977c8ac73b38bfcd77251fd9942b6c7406eeae26086d83493","md5":"f68850e22c71718d5dd3a1cac72a86ed","sha256":"4e94666f340d54f236483f047e30cf8c0e95321c554d3ec133612b3c2b2c5362"},"downloads":-1,"filename":"changedetection_io-0.47.5.tar.gz","has_sig":false,"md5_digest":"f68850e22c71718d5dd3a1cac72a86ed","packagetype":"sdist","python_version":"source","requires_python":">=3.10","size":580227,"upload_time":"2024-10-31T21:52:53","upload_time_iso_8601":"2024-10-31T21:52:53.213989Z","url":"https://files.pythonhosted.org/packages/82/72/c8337c24fd8977c8ac73b38bfcd77251fd9942b6c7406eeae26086d83493/changedetection_io-0.47.5.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[{"aliases":["CVE-2024-51998"],"details":"### Summary\n\nThe validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.\n\n### Details\n\nThe check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13\n\nIt later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.\n\n> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.\n> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)\n\nhttps://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41\n\n### PoC\n\n1. Open up a changedetection.io instance with a webdriver configured\n2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode\n3. Wait for it to be checked\n4. Open preview\n5. Notice contents of the file\n","fixed_in":["0.47.6"],"id":"GHSA-6jrf-rcjf-245r","link":"https://osv.dev/vulnerability/GHSA-6jrf-rcjf-245r","source":"osv","summary":null,"withdrawn":null}]},"0.47.6":{"info":{"author":"dgtlmoon","author_email":null,"bugtrack_url":null,"classifiers":["Intended Audience :: Customer Service","Intended Audience :: Developers","Intended Audience :: Education","Intended Audience :: End Users/Desktop","Intended Audience :: Financial and Insurance Industry","Intended Audience :: Healthcare Industry","Intended Audience :: Information Technology","Intended Audience :: Legal Industry","Intended Audience :: Manufacturing","Intended Audience :: Other Audience","Intended Audience :: Religion","Intended Audience :: Science/Research","Intended Audience :: System Administrators","Intended Audience :: Telecommunications Industry","Topic :: Education","Topic :: Internet","Topic :: Internet :: WWW/HTTP :: Browsers","Topic :: Internet :: WWW/HTTP :: Dynamic Content","Topic :: Internet :: WWW/HTTP :: Indexing/Search","Topic :: Internet :: WWW/HTTP :: Site Management","Topic :: Internet :: WWW/HTTP :: Site Management :: Link Checking","Topic :: Office/Business","Topic :: Other/Nonlisted Topic","Topic :: Scientific/Engineering :: Information Analysis","Topic :: Text Processing :: Markup :: HTML","Topic :: Utilities"],"description_content_type":"text/markdown","docs_url":null,"download_url":null,"downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://changedetection.io","keywords":"website change monitor for changes notification change detection alerts tracking website tracker change alert website and monitoring","license":"Apache License 2.0","maintainer":null,"maintainer_email":null,"name":"changedetection.io","package_url":"https://pypi.org/project/changedetection.io/","platform":null,"project_url":"https://pypi.org/project/changedetection.io/","project_urls":{"Homepage":"https://changedetection.io"},"provides_extra":null,"release_url":"https://pypi.org/project/changedetection.io/0.47.6/","requires_dist":["pyee","eventlet>=0.36.1","feedgen~=0.9","flask-compress","flask-login>=0.6.3","flask-paginate","flask-expects-json~=1.7","flask-restful","flask-cors","flask-wtf~=1.2","flask~=2.3","inscriptis~=2.2","pytz","timeago~=1.0","validators~=0.21","brotli~=1.0","requests[socks]","requests-file","urllib3==1.26.19","chardet>2.3.0","wtforms~=3.0","jsonpath-ng~=1.5.3","dnspython==2.6.1","apprise==1.9.0","paho-mqtt<2.0.0,>=1.6.1","cryptography~=42.0.8","beautifulsoup4","lxml!=5.2.0,!=5.2.1,<6,>=4.8.0","elementpath==4.1.5","selenium~=4.14.0","werkzeug==3.0.6","jinja2~=3.1","jinja2-time","openpyxl","pyppeteer-ng==2.0.0rc5","pyppeteerstealth>=0.0.4","pytest~=7.2","pytest-flask~=1.2","jsonschema~=4.0","loguru","extruct","babel","greenlet>=3.0.3","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"darwin\"","jq~=1.3; python_version >= \"3.8\" and sys_platform == \"linux\""],"requires_python":">=3.10","summary":"Website change detection and monitoring service, detect changes to web pages and send alerts/notifications.","version":"0.47.6","yanked":false,"yanked_reason":null},"last_serial":25879380,"urls":[{"comment_text":"","digests":{"blake2b_256":"57bbd0eec1943eaed5f1960512cbd6752a32b3af29fda313233328f9a2f4ad47","md5":"452d36a3fa2395769b696bc8fa7a36fd","sha256":"a1dd7bb39915268ea82b76022034ed228985f686040be93bb6ffacafcf0ee00c"},"downloads":-1,"filename":"changedetection.io-0.47.6-py3-none-any.whl","has_sig":false,"md5_digest":"452d36a3fa2395769b696bc8fa7a36fd","packagetype":"bdist_wheel","python_version":"py3","requires_python":">=3.10","size":682243,"upload_time":"2024-11-07T19:43:13","upload_time_iso_8601":"2024-11-07T19:43:13.677743Z","url":"https://files.pythonhosted.org/packages/57/bb/d0eec1943eaed5f1960512cbd6752a32b3af29fda313233328f9a2f4ad47/changedetection.io-0.47.6-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"34cdd03ebf188ce2679526c86ebe9bcdc56a27a3d54a98e00f2c727767a18db7","md5":"e8bf5e17f1f38c1f1a4646a6e0b5635e","sha256":"b700a21afbe5ba1fdb6100f56e15b6169de7069b8c0811df11239af4b099fa94"},"downloads":-1,"filename":"changedetection_io-0.47.6.tar.gz","has_sig":false,"md5_digest":"e8bf5e17f1f38c1f1a4646a6e0b5635e","packagetype":"sdist","python_version":"source","requires_python":">=3.10","size":580416,"upload_time":"2024-11-07T19:43:15","upload_time_iso_8601":"2024-11-07T19:43:15.528906Z","url":"https://files.pythonhosted.org/packages/34/cd/d03ebf188ce2679526c86ebe9bcdc56a27a3d54a98e00f2c727767a18db7/changedetection_io-0.47.6.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[]}}